{"version":3,"sources":["./node_modules/@angular/material/expansion/typings/index.d.ts.MatExpansionPanel.html","./node_modules/@angular/material/expansion/typings/index.d.ts.MatExpansionPanelHeader.html","./src/@tdm/ngx-dynamic-forms/src/dynamic-forms/dynamic-form-override.directive.ts","./src/@tdm/ngx-dynamic-forms/src/tdm-model-form/tdm-model-form.service.ts","./src/@tdm/ngx-dynamic-forms/src/dynamic-forms/dynamic-form-array.component.ts","./src/@tdm/ngx-dynamic-forms/src/core/ng-forms-bound-mapper.ts","./src/@tdm/ngx-dynamic-forms/src/create-control.ts","./src/@tdm/ngx-dynamic-forms/src/core/decorators.ts","./src/demo/modules/@shared/toc/toc.component.html","./node_modules/@angular/material/sidenav/typings/index.d.ts.MatDrawerContent.html","./node_modules/@angular/material/sidenav/typings/index.d.ts.MatDrawer.html","./node_modules/@angular/material/sidenav/typings/index.d.ts.MatDrawerContainer.html","./node_modules/@angular/material/sidenav/typings/index.d.ts.MatSidenavContent.html","./node_modules/@angular/material/sidenav/typings/index.d.ts.MatSidenav.html","./node_modules/@angular/material/sidenav/typings/index.d.ts.MatSidenavContainer.html","./src/@tdm/ngx-dynamic-forms/src/core/metadata/form-model.ts","./src/@tdm/ngx-dynamic-forms/src/dynamic-forms/dynamic-form-control.directive.ts","./src/@tdm/ngx-dynamic-forms/src/dynamic-forms/dynamic-control-outlet.directive.ts","./src/@tdm/ngx-dynamic-forms/src/dynamic-forms/dynamic-form.component.ts","./src/demo/modules/@shared/components/markdown-view/markdown-view.component.html","./src/demo/modules/@shared/components/tutorial-page/tutorial-page.component.html","./src/@tdm/ngx-dynamic-forms/src/dynamic-forms/dynamic-form-array.directive.ts","./src/@tdm/ngx-dynamic-forms/src/module.ts","./node_modules/@angular/material/icon/typings/index.d.ts.MatIcon.html","./src/@tdm/ngx-dynamic-forms/src/prop-notify.ts","./node_modules/@angular/material/list/typings/index.d.ts.MatNavList.html","./node_modules/@angular/material/list/typings/index.d.ts.MatList.html","./node_modules/@angular/material/list/typings/index.d.ts.MatListItem.html","./node_modules/@angular/material/list/typings/index.d.ts.MatListOption.html","./node_modules/@angular/material/list/typings/index.d.ts.MatSelectionList.html","./src/@tdm/ngx-dynamic-forms/src/utils.ts","./src/@tdm/ngx-dynamic-forms/src/tdm-model-form/tdm-model-form.ts","./src/@tdm/ngx-dynamic-forms/src/tdm-model-form/tdm-model-form.directive.ts","./src/demo/modules/@shared/components/feature-list/feature-list.component.html","./src/@tdm/ngx-dynamic-forms/src/dynamic-forms/before-render-event-handler.ts","./src/@tdm/ngx-dynamic-forms/src/validation.ts","./src/@tdm/ngx-dynamic-forms/src/tdm-model-form/render-instruction.ts","./src/@tdm/ngx-dynamic-forms/src/create-child-form-event.ts","./src/demo/modules/@shared/components/package-welcome/package-welcome.component.html","./node_modules/rxjs/_esm5/operator/toPromise.js","./src/@tdm/ngx-dynamic-forms/src/default-renderer.ts","./src/@tdm/ngx-dynamic-forms/src/core/metadata/form-prop.ts","./node_modules/@angular/material/core/typings/index.d.ts.MatOption.html","./node_modules/@angular/material/core/typings/index.d.ts.MatOptgroup.html","./src/@tdm/ngx-dynamic-forms/src/core/angular-forms-mapper.ts"],"names":["__WEBPACK_IMPORTED_MODULE_0__angular_core__","_l","_v","en","$event","ad","_co","component","View_MatExpansionPanel_1","__WEBPACK_IMPORTED_MODULE_7__angular_cdk_portal__","portal","_ck","_portal","_getExpandedState","expanded","_headerId","id","View_MatExpansionPanelHeader_1","__WEBPACK_IMPORTED_MODULE_2__angular_common__","ngIf","_showToggle","ControlSelectorBase","this","filter","names","vTypes","Object","defineProperty","prototype","controlName","isMatching","rd","vType","indexOf","name","ngOnChanges","changes","syncQuery","Array","isArray","__WEBPACK_IMPORTED_MODULE_2__tdm_core_tdm__","DynamicFormOverrideDirective","_super","template","_this","call","__WEBPACK_IMPORTED_MODULE_0_tslib__","createRI","formProp","assign","parent","renderInstructions","__WEBPACK_IMPORTED_MODULE_2__render_instruction__","createVRI","isPrimitive","isVirtual","virtualChildren","TDMModelFormService","cache","Map","getMeta","type","__WEBPACK_IMPORTED_MODULE_0__tdm_core_tdm__","getMetaFor","__WEBPACK_IMPORTED_MODULE_3__core_index__","undefined","getInstructions","get","_getInstructions","create","instance","formGroup","tdmModelForm","__WEBPACK_IMPORTED_MODULE_1__tdm_model_form__","setContext","createRICloneFactory","propChange","parentMap","propNotifier","onPropChange","value","riClone","renderInstruction","children","map","c","parent_1","set","push","props","getTargetMeta","getValues","formMeta","instructions","_i","props_1","length","p","getProp","exclude","typeMeta","rtType","localInstructions","name_1","parent_2","flatten","childForm","applyFlatten","path","depthFromArray","arrayPath","slice","join","_a","keys","key","len","concat","flattened","_arrayPath","DynamicFormArray","cfr","dynForm","ready","tdmForm","fArray","item","fGroup","updateControls","vcRef","clear","getComponentRenderer","componentFactory","resolveComponentFactory","controls","childControl","_b","_c","childItem","resolveFormArrayChild","override","getOverride","$implicit","_d","__WEBPACK_IMPORTED_MODULE_2__angular_forms__","createEmbeddedView","createComponent","fControl","tdmOnControlContextInit","NgFormsBoundDeserializeMapper","sourceType","plainMapper","deserializeFlattened","control","resultOrKey","__WEBPACK_IMPORTED_MODULE_1__tdm_core_tdm__","__WEBPACK_IMPORTED_MODULE_2__angular_forms_mapper__","NgFormsBoundMapper","meta","fg","serialize","deserialize","createControl","FormModel","metaArgs","formModel","def","decorator","__WEBPACK_IMPORTED_MODULE_1__metadata_index__","on","processType","target","tMeta","modelProps","formModelMeta_1","asKeyValArray","forEach","v","addProp","getCreateProp","tocArea","tocTitle","View_TocComponent_4","__WEBPACK_IMPORTED_MODULE_1__angular_common__","ngTemplateOutletContext","ngTemplateOutlet","rootUrl","link","context","linkTemplate","level","activeLink","View_TocComponent_2","View_TocComponent_3","ngForOf","View_TocComponent_1","View_TocComponent_5","transform","linksChanged","View_MatDrawerContent_0","RenderType_MatDrawerContent","__WEBPACK_IMPORTED_MODULE_6__angular_cdk_scrolling__","__WEBPACK_IMPORTED_MODULE_1__angular_material_sidenav__","_margins","left","right","View_MatDrawerContainer_1","_content","_isShowingBackdrop","View_MatSidenavContent_0","RenderType_MatSidenavContent","View_MatSidenavContainer_1","FormModelMetadata","info","validator","asyncValidator","prop","propertyKey","single","allowOn","proxy","host","containerKey","DynamicFormControlDirective","defaultVCRef","render","outlet","getOutlet","_vcRef","_tRef","bindRenderingData","injector","resolver","cmpRef","hostView","detectChanges","insert","detach","DynamicControlOutletDirective","tRef","previousValue","detachControlOutlet","attachControlOutlet","ngOnDestroy","setHidden","ri","hidden","_dSelf","_dParent","markAsChanged","tryRunOnChildren","child","setHiddenParent","DynamicFormComponent","tdmModelFormService","controlRenderer","kvDiffers","itDiffers","renderer","filterMode","valueChanges","__WEBPACK_IMPORTED_MODULE_4__angular_core__","beforeRender","__WEBPACK_IMPORTED_MODULE_1_rxjs_BehaviorSubject__","subscriptions","stateDiffer","rendering$","_ngNativeValidate","outlets","Set","overrideMap","outletMap","rendererEvent$","pendingUpdates","codeOverrides","renderState","asObservable","rendererEvent","__WEBPACK_IMPORTED_MODULE_5__tdm_core_tdm__","defaultControlRenderer","Error","form","native","setNativeValidation","slaveMode","subscribe","e","emit","add","delete","redraw","returnPromise","update","getValue","Promise","resolve","__WEBPACK_IMPORTED_MODULE_2_rxjs_operator_toPromise__","pipe","__WEBPACK_IMPORTED_MODULE_3_rxjs_operators__","state","model","onModelChange","hotBind","__WEBPACK_IMPORTED_MODULE_7__utils__","disabled","onDisableChange","currentValue","onStateChange","disabledState","hiddenState","ngDoCheck","diff","handleDiff","ngAfterContentInit","renderData","afterInit","updateOverrides","s","overrides","ngAfterViewInit","subs","pop","unsubscribe","complete","getControl","addOverride","query","d","__WEBPACK_IMPORTED_MODULE_8__dynamic_form_override_directive__","isCatchAll","wildOverride","emitRendererEvent","event","required","validators","asyncValidators","fullName","getValidators","setValidators","setAsyncValidators","label","ordinal","__WEBPACK_IMPORTED_MODULE_6__tdm_model_form_index__","constructor","valueDiffer","formValue","getRawValue","find","disable","applyFormListener","enable","match","ow","controlsReady","setTimeout","emitRenderingState","controlsMap","toArray","from","values","filterMatch","fullPath","isStaticPathContainsPath","o","renderEvent","__WEBPACK_IMPORTED_MODULE_9__before_render_event_handler__","done","all","catch","err","then","next","sort","a","b","pathList","idx","findIndex","nextChar","freeze","propNotifyHandler","freezeValueChanges","arr_1","forEachChangedItem","change","isFlattenedProp","apply","drillDownChange","some","r","result","differ","deep","formElRef","removeAttribute","nativeElement","setAttribute","forEachAddedItem","record","forEachRemovedItem","findRenderInstructionByKey","dotProperty","substr","split","__WEBPACK_IMPORTED_MODULE_1__angular_core__","markdown","code","lang","View_TdmMarkdownViewComponent_1","View_TdmMarkdownViewComponent_2","overflowContainer","__WEBPACK_IMPORTED_MODULE_2__angular_material_list__","tutorial","subHeader","View_TutorialPageComponent_2","__WEBPACK_IMPORTED_MODULE_3__angular_common__","__WEBPACK_IMPORTED_MODULE_5__angular_router__","routerLinkActive","links","linksWithHrefs","_lines","_hasAvatar","href","__WEBPACK_IMPORTED_MODULE_6__node_modules_angular_material_sidenav_typings_index_ngfactory__","__WEBPACK_IMPORTED_MODULE_7__angular_material_sidenav__","__WEBPACK_IMPORTED_MODULE_8__angular_cdk_bidi__","autosize","_drawers","__WEBPACK_IMPORTED_MODULE_4__node_modules_angular_material_list_typings_index_ngfactory__","View_TutorialPageComponent_1","__WEBPACK_IMPORTED_MODULE_14__toc_toc_component_ngfactory__","__WEBPACK_IMPORTED_MODULE_15__toc_toc_component__","View_TutorialPageComponent_3","__WEBPACK_IMPORTED_MODULE_16__toc_toc_link_template__","tutorialsChanged","_animationState","position","mode","forFormArrayContextKeys","ForFormArrayDirective","differs","formArrayDiffer","grouped","forFormArrayContextKeys_1","k","trySetDiffer","isFirstChange","applyFormArrayChanges","renderers","forEachOperation","adjustedPreviousIndex","currentIndex","previousIndex","convert","prevValues","splice","forEachIdentityChange","newValues","controls_1","__WEBPACK_IMPORTED_MODULE_3__angular_forms__","DynamicFormsModule","forRoot","formComponent","ngModule","providers","__WEBPACK_IMPORTED_MODULE_1__tdm_model_form_index__","provide","multi","useValue","__WEBPACK_IMPORTED_MODULE_2__default_renderer__","forChild","__webpack_exports__","__propertyKey","curr","isFirst","prev","changes_1","IN_FLIGHT_PROP_CHANGE","WeakMap","__WEBPACK_IMPORTED_MODULE_5__angular_material_core__","__WEBPACK_IMPORTED_MODULE_4__angular_cdk_platform__","trigger","_isRippleDisabled","_getHostElement","unbounded","__WEBPACK_IMPORTED_MODULE_7__core_typings_index_ngfactory__","selected","checkboxPosition","objectToForm","obj","data","__WEBPACK_IMPORTED_MODULE_0__angular_forms__","serialized_1","ctrl","serializePlain","addControl","getFormIsNotArrayErrorMessage","normalizeFormPath","isNumberRe","pathArr","n","test","shift","TDMModelForm","modelFormService","bind","_model","_type","_ready","_renderData","clone","getValueModel","__WEBPACK_IMPORTED_MODULE_4__render_instruction__","getRuntimePath","m","pathArr_1","setValue","options","hasError","errorCode","sync","patch","patchValue","reset","formArray","resetFormArray","resetControl","getFormProp","setControl","createChildForm","ref","tryCreateNew","__WEBPACK_IMPORTED_MODULE_3__create_control__","appendControl","removeControl","removeAt","trackBy","hash","commitToModel","onlyIfDirty","dirty","mapper","__WEBPACK_IMPORTED_MODULE_2__core_index__","staticPath","value_1","TDMModelFormDirective","__WEBPACK_IMPORTED_MODULE_2__markdown_view_markdown_view_component_ngfactory__","__WEBPACK_IMPORTED_MODULE_3__markdown_view_markdown_view_component__","__WEBPACK_IMPORTED_MODULE_4__angular_platform_browser__","description","__WEBPACK_IMPORTED_MODULE_5__node_modules_angular_material_expansion_typings_index_ngfactory__","__WEBPACK_IMPORTED_MODULE_6__angular_material_expansion__","__WEBPACK_IMPORTED_MODULE_7__angular_cdk_collections__","_lazyContent","__WEBPACK_IMPORTED_MODULE_9__node_modules_angular_material_icon_typings_index_ngfactory__","__WEBPACK_IMPORTED_MODULE_10__angular_material_icon__","View_TdmFeatureListComponent_2","__WEBPACK_IMPORTED_MODULE_11__angular_common__","View_TdmFeatureListComponent_3","md","_hasSpacing","panel","_getPanelId","_isExpanded","collapsedHeight","expandedHeight","title","View_TdmFeatureListComponent_1","features","asyncUsed","BeforeRenderEventHandler","notify","async","__WEBPACK_IMPORTED_MODULE_0_rxjs_operator_toPromise__","normValidators","builtIn","compose","composeAsync","RenderInstruction","__WEBPACK_IMPORTED_MODULE_2__core_metadata_form_prop__","EMPTY","writable","mergeData","getData","root","__WEBPACK_IMPORTED_MODULE_1__angular_forms__","__WEBPACK_IMPORTED_MODULE_3__validation__","__WEBPACK_IMPORTED_MODULE_4__prop_notify__","ctx","mergeCtx","createdTDMModelForm","rootTdmForm","baseCtx","cloneContext","isNew","createTDMModelForm","onlySelf","__WEBPACK_IMPORTED_MODULE_4__angular_material_button__","__WEBPACK_IMPORTED_MODULE_5__angular_cdk_platform__","__WEBPACK_IMPORTED_MODULE_6__angular_cdk_a11y__","color","buttonLink","buttonText","installCmd","toPromise","__webpack_require__","FORM_CONTROL_COMPONENT","BASE_RENDERER","Number","MAX_SAFE_INTEGER","FormPropMetadata","hasOwnProperty","defaultValue","FormPropMetadata_1","extend","View_MatPseudoCheckbox_0","RenderType_MatPseudoCheckbox","__WEBPACK_IMPORTED_MODULE_1__angular_material_core__","multiple","disableRipple","_labelId","deepGetFormProp","__WEBPACK_IMPORTED_MODULE_3__metadata_index__","propMeta","hasTarget","NgFormsDeserializeMapper","raw","getIdentity","identity","getKeys","parseFormArray","parseFormGroup","deserializer","i","forceSerialize","keys_1","childCtrl","NgFormsSerializeMapper","container","source","serializeCollection","serializeObject","forEachRaw","cls","idKey","getIdentityKey","ignoreArray","__WEBPACK_IMPORTED_MODULE_5__validation__","syncValidator","createFlatten","value_2","serializeChild","__WEBPACK_IMPORTED_MODULE_4__utils__","value_3","keys_2","flattenedControl","NgFormsChildSerializeMapper","arr"],"mappings":"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","file":"common.e1b0a48c4a8f8f47c4e2.chunk.js","sourcesContent":["<ng-content select=\"mat-expansion-panel-header\"></ng-content><div class=\"mat-expansion-panel-content\" role=\"region\" [@bodyExpansion]=\"_getExpandedState()\" (@bodyExpansion.done)=\"_bodyAnimation($event)\" (@bodyExpansion.start)=\"_bodyAnimation($event)\" [class.mat-expanded]=\"expanded\" [attr.aria-labelledby]=\"_headerId\" [id]=\"id\" #body><div class=\"mat-expansion-panel-body\"><ng-content></ng-content><ng-template [cdkPortalOutlet]=\"_portal\"></ng-template></div><ng-content select=\"mat-action-row\"></ng-content></div>\n\n\n// WEBPACK FOOTER //\n// ./node_modules/@angular/material/expansion/typings/index.d.ts.MatExpansionPanel.html","<span class=\"mat-content\"><ng-content select=\"mat-panel-title\"></ng-content><ng-content select=\"mat-panel-description\"></ng-content><ng-content></ng-content></span><span [@indicatorRotate]=\"_getExpandedState()\" *ngIf=\"_showToggle()\" class=\"mat-expansion-indicator\"></span>\n\n\n// WEBPACK FOOTER //\n// ./node_modules/@angular/material/expansion/typings/index.d.ts.MatExpansionPanelHeader.html","import { Directive, Input, Inject, forwardRef, TemplateRef, SimpleChanges, OnChanges } from '@angular/core';\nimport { isString } from '@tdm/core/tdm';\n\nimport { FormElementType } from '../interfaces';\nimport { RenderInstruction } from '../tdm-model-form/render-instruction';\nimport { DynamicControlRenderContext } from '../tdm-model-form/tdm-model-form';\n\nexport interface DynamicFormOverrideContext {\n  $implicit: DynamicControlRenderContext;\n}\n\nexport class ControlSelectorBase implements OnChanges {\n  controlName: string | string[];\n  vType: keyof FormElementType | Array<keyof FormElementType>;\n\n  /**\n   * Returns true when the control name is catch all\n   */\n  get isCatchAll(): boolean {\n    return this.controlName === '*';\n  }\n\n  protected filter = {\n    names: [] as string[],\n    vTypes: [] as Array<keyof FormElementType>\n  };\n\n  isMatching(rd: RenderInstruction): boolean {\n    return (!this.vType || this.filter.vTypes.indexOf(rd.vType) > - 1)\n      && (this.controlName && (this.controlName === '*' || this.controlName.indexOf(rd.name) > -1) );\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if ('controlName' in changes || 'vType' in changes) {\n      this.syncQuery();\n    }\n  }\n\n  syncQuery(): void {\n    this.filter.names = Array.isArray(this.controlName)\n      ? this.controlName\n      : isString(this.controlName) ? [this.controlName] : [];\n\n    this.filter.vTypes = Array.isArray(this.vType)\n      ? this.vType\n      : isString(this.vType) ? [this.vType] : [];\n  }\n}\n\n/**\n * A directive that allows override the default renderer for a form control name.\n *\n * @example\n *\n * ```html\n * <dynamic-form #df [model]=\"data.user\" [exclude]=\"['remotePassword']\">\n *   <md-input-container *dynamicFormOverride=\"'localUser'; let ctx\" [formGroup]=\"ctx.fGroup\" >\n *     <input type=\"password\" [formControl]=\"ctx.fControl\" mdInput [placeholder]=\"ctx.item.label\">\n *   </md-input-container>\n * </dynamic-form>\n * ```\n *\n */\n@Directive({\n  selector: '[dynamicFormOverride]',\n  exportAs: 'dynamicFormOverride'\n})\nexport class DynamicFormOverrideDirective extends ControlSelectorBase {\n\n  @Input('dynamicFormOverride') controlName: string | string[];\n  @Input('dynamicFormOverrideVType') vType: keyof FormElementType | Array<keyof FormElementType>;\n\n  constructor(public template: TemplateRef<DynamicFormOverrideContext>) { // tslint:disable-line\n    super();\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/@tdm/ngx-dynamic-forms/src/dynamic-forms/dynamic-form-override.directive.ts","import { Injectable, Type } from '@angular/core';\nimport { FormGroup } from '@angular/forms';\nimport { targetStore, PropMetadata } from '@tdm/core/tdm';\nimport { TDMModelForm } from './tdm-model-form';\nimport { RenderInstruction } from './render-instruction';\nimport { PropNotifier, PropNotifyHandler } from '../prop-notify';\n\nimport { FormModelMetadata, FormPropMetadata } from '../core/index';\n\nfunction createRI(formProp: FormPropMetadata,\n                  name: string,\n                  assign: any,\n                  parent?: RenderInstruction): RenderInstruction {\n  const renderInstructions = new RenderInstruction(name, formProp, parent);\n\n  Object.assign(renderInstructions, assign);\n  return renderInstructions;\n}\n\nfunction createVRI(formProp: FormPropMetadata,\n                   name: string,\n                   parent?: RenderInstruction): RenderInstruction {\n  return createRI(formProp, name, { isPrimitive: false, isVirtual: true, virtualChildren: [] }, parent);\n}\n\n/**\n * A service for creating new instances of TDMModelForm\n */\n@Injectable()\nexport class TDMModelFormService {\n  private cache = new Map<Type<any>, RenderInstruction[]>();\n\n  getMeta(type: Type<any>): FormModelMetadata {\n    return type\n      ? targetStore.getMetaFor(type, FormModelMetadata, true)\n      : undefined\n    ;\n  }\n\n  getInstructions(type: Type<any>): RenderInstruction[] {\n    return this.cache.get(type) || this._getInstructions(type);\n  }\n\n  create<T>(instance: T): TDMModelForm<T>;\n  create<T>(instance: T, type: Type<T>): TDMModelForm<T>;\n  create<T>(instance: T, formGroup: FormGroup): TDMModelForm<T>;\n  create<T>(instance: T, type: Type<T>, formGroup: FormGroup): TDMModelForm<T>;\n  create<T>(instance: T, type?: Type<T> | FormGroup, formGroup?: FormGroup): TDMModelForm<T> {\n    const tdmModelForm = new TDMModelForm<T>(this);\n    tdmModelForm.setContext(instance, <any> type, formGroup);\n    return tdmModelForm;\n  }\n\n  /**\n   * Returns a clone function for cloning [[RenderInstruction]] instances.\n   * The clone function returned can be used to clone a single cycle of instructions returned from\n   * [[TDMModelFormService.getInstructions]] so create a new clone function for each iteration cycle.\n   *\n   * We need to clone [[RenderInstruction]] because they represent metadata while a form represents a single instance\n   * that re-occurs thus can not change the metadata and must use a copy.\n   * Instead of recreating the metadata over and over we just use JS's prototype to create layers over the metadata that\n   * act as instances while not duplicating the data.\n   */\n  createRICloneFactory<T extends RenderInstruction>(propChange?: PropNotifyHandler): (ri: T) => T {\n    // We clone a [[RenderInstruction]] by creating a new layer in the prototype chain so the current layer can not be\n    // changed by assigning but can be used when retrieving, this saves space and time.\n    // Usually Object.create() is the only thing we need but there are 2 special cases: Arrays and `flatten` expressions\n    // Array's and `flatten` expressions (virtual rendering instruction) which requires special attention.\n    //\n    // Array's represent a [[RenderInstruction]] for a property of type Array<T> where the [[RenderInstruction]]\n    // instance represents the array and the `children` property in it represents a list of [[RenderInstruction]]\n    // instances representing T. The children are not part of the rendering instructions, only the array it self so when\n    // cloning the children are not cloned so we need to handle them internally.\n    //\n    // Virtual's (flatten expressions) represent a form group which get's converted into a list of [[RenderInstruction]]\n    // instances with the virtual as parent but the virtual itself is never a part of the instructions.\n    // So, when cloning, we also need to clone the virtual but we need to make sure not to clone it multiple times as\n    // next call's will be from another child of the same virtual. We do that by using a map to make sure we are\n    // cloning a virtual one time only. This is why a clone function is good for one cycle.\n\n    // map for storing used virtual's\n    const parentMap = new Map<any, any>();\n    const propNotifier: { [P in keyof PropNotifier]?: { value: PropNotifier[P] } } = propChange\n      ? { onPropChange: { value: propChange } }\n      : undefined\n    ;\n    const riClone = <Z extends RenderInstruction>(renderInstruction: Z): Z => {\n      const rd: Z = Object.create(renderInstruction, propNotifier);\n      if (rd.isArray) {\n        rd.children = rd.children.map( c =>  riClone(c) );\n        // we take 1 child and climb up till we get to the virtual that has this array as parent\n        // we set this array as that parent, replaces the before-cloned value.\n        // we only need one child as it is a reference.\n        let c = rd.children[0];\n        while (c) {\n          if (c.parent === renderInstruction) {\n            c.parent = rd;\n            c = null;\n          } else {\n            c = c.parent;\n          }\n        }\n      } else if (rd.parent && rd.parent.isVirtual) {\n        let parent = parentMap.get(rd.parent);\n        if (!parent) {\n          parent = riClone(rd.parent);\n          parent.virtualChildren = [];\n          parentMap.set(rd.parent, parent);\n        }\n        rd.parent = parent;\n        parent.virtualChildren.push(rd);\n      }\n      return rd;\n    };\n    return riClone;\n  }\n\n  private _getInstructions(type: Type<any>): RenderInstruction[] {\n    // NOTE: The logic for creating instructions is tightly coupled with the logic for cloning the instructions.\n    //       Make sure changes in the logic are reflected in `createRICloner()`\n    const props = targetStore.getTargetMeta(type).getValues(PropMetadata);\n    const formMeta = this.getMeta(type);\n    const instructions: RenderInstruction[] = [];\n    for (let p of props) {\n      const formProp = formMeta.getProp(p.name as string);\n      if (!formProp) {\n        instructions.push(new RenderInstruction(p.name as string));\n      } else if (!formProp.exclude) {\n        const typeMeta = formProp.rtType || p.type;\n\n        let localInstructions: RenderInstruction[] = instructions;\n        let name: TdmPropertyKey  = p.name;\n        let parent: RenderInstruction;\n        const isPrimitive = !(formProp.flatten || formProp.childForm);\n        if (typeMeta && typeMeta.isArray) {\n          parent = createRI(formProp, name as string, { isArray: true, isPrimitive, children: localInstructions = [] });\n          instructions.push(parent);\n        }\n\n        if (formProp.flatten) {\n          this.applyFlatten(\n            formProp.flatten,\n            [name as string],\n            localInstructions,\n            createVRI(formProp, name as string, parent),\n            parent && parent.isArray ? 0 : undefined\n          );\n        } else {\n          localInstructions.push(createRI(formProp, name as string, { isPrimitive }, parent));\n        }\n      }\n    }\n    this.cache.set(type, instructions);\n    return instructions;\n  }\n\n  private applyFlatten(props: { [keys: string]: FormPropMetadata },\n                       path: Array<string | number>,\n                       instructions: RenderInstruction[],\n                       parent: RenderInstruction,\n                       // -1000 should be low enough :)\n                       depthFromArray: number = -1000): void {\n    /* The `depthFromArray` marks the nested object count from the last array up in the parent tree\n       The depth 0 means the immediate child of the array and so on...\n       When the depth is negative (or not set) it means that there is no array ancestor.\n     */\n    const arrayPath = depthFromArray > 0\n      ? path.slice(path.length - depthFromArray).join('.') + '.'\n      : ''\n    ;\n\n    for (let key of Object.keys(props)) {\n      const p = props[key];\n      const isPrimitive = !(p.flatten || p.childForm);\n      const isArray = p.rtType && p.rtType.isArray;\n      const localInstructions: RenderInstruction[] = isArray ? [] : instructions;\n\n      if (p.rtType && p.rtType.isArray) {\n        parent = createRI(p, key as string, { isArray, isPrimitive, children: localInstructions }, parent);\n        instructions.push(parent);\n        // we set to -1 so it will bump to 0 if `p.flatten`, making the first item in depth 0 since current item is\n        // the array. If no `p.flatten` then it's a primitive and we don't want `_arrayPath` for primitive arrays.\n        depthFromArray = -1;\n      }\n\n      if (p.flatten) {\n        const len = localInstructions.length;\n        this.applyFlatten(\n          p.flatten,\n          path.concat([key]),\n          localInstructions,\n          createVRI(p, key, parent),\n          depthFromArray + 1\n        );\n\n        // if localInstructions added, get the parent of the last added, it's a virtual child\n        if (localInstructions.length > len) {\n          parent.virtualChildren.push(localInstructions[localInstructions.length - 1].parent);\n        }\n      } else {\n        const renderInstruction = createRI(p, key as string, { isPrimitive, flattened: path }, parent);\n        parent.virtualChildren.push(renderInstruction);\n        localInstructions.push(renderInstruction);\n        if (depthFromArray >= 0) {\n          renderInstruction._arrayPath = arrayPath + renderInstruction.name;\n        }\n      }\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/@tdm/ngx-dynamic-forms/src/tdm-model-form/tdm-model-form.service.ts","import {\n  ComponentFactoryResolver,\n  Component,\n  Input,\n  ViewContainerRef,\n  ViewChild,\n  OnChanges,\n  SimpleChanges\n} from '@angular/core';\nimport { FormArray, FormGroup } from '@angular/forms';\n\nimport { TDMModelForm, RenderInstruction, DynamicControlRenderContext } from '../tdm-model-form/index';\nimport { DynamicFormComponent } from './dynamic-form.component';\n\nexport abstract class DynamicFormArray implements OnChanges {\n  dynForm: DynamicFormComponent;\n  fArray: FormArray;\n  fGroup: FormGroup;\n  item: RenderInstruction;\n  tdmForm: TDMModelForm<any>;\n  abstract vcRef: ViewContainerRef;\n\n  private ready: boolean = false;\n\n  constructor(private cfr: ComponentFactoryResolver,\n              dynForm: DynamicFormComponent<any>) {\n    if (dynForm) {\n      this.dynForm = dynForm;\n    }\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes.tdmForm || changes.fArray || changes.item || changes.fGroup) {\n      if (this.ready !== !!(this.tdmForm && this.fArray && this.fGroup && this.item && this.item.isArray) ) {\n        this.ready = !this.ready;\n        this.updateControls();\n      }\n    }\n  }\n\n  private updateControls(): void {\n    this.vcRef.clear();\n    if (this.ready) {\n      const component = this.dynForm.getComponentRenderer(this.item);\n      const componentFactory = this.cfr.resolveComponentFactory(component);\n\n      for (let childControl of this.fArray.controls) {\n        for (let childItem of this.item.children) {\n          const c = childItem.resolveFormArrayChild(childControl);\n          const override = this.dynForm.getOverride(childItem);\n          if (override) {\n            const $implicit: DynamicControlRenderContext  = <any> {\n              item: childItem,\n              fGroup: this.fGroup,\n              tdmForm: this.tdmForm,\n              [c instanceof FormArray ? 'fArray' : 'fControl']: c\n            };\n            this.vcRef.createEmbeddedView(\n              override.template, { $implicit } );\n          } else {\n            const cmpRef = this.vcRef.createComponent<DynamicControlRenderContext> (\n              componentFactory,\n              this.vcRef.length\n            );\n            const { instance } = cmpRef;\n            instance.item = childItem;\n            instance.fGroup = this.fGroup;\n            instance.tdmForm = this.tdmForm;\n            if (c instanceof FormArray) {\n              instance.fArray = c;\n            } else {\n              instance.fControl = <any> c;\n            }\n            if (typeof instance.tdmOnControlContextInit === 'function') {\n              instance.tdmOnControlContextInit();\n            }\n          }\n        }\n      }\n    }\n  }\n}\n\n// tslint:disable-next-line\n@Component({\n  selector: 'dynamic-form-array',\n  templateUrl: './dynamic-form-array.component.html'\n})\nexport class DynamicFormArrayComponent extends DynamicFormArray {\n  @Input() dynForm: DynamicFormComponent;\n  @Input() fArray: FormArray;\n  @Input() fGroup: FormGroup;\n  @Input() item: RenderInstruction;\n  @Input() tdmForm: TDMModelForm<any>;\n\n  @ViewChild('viewRef', { read: ViewContainerRef }) vcRef: ViewContainerRef;\n\n  constructor(cfr: ComponentFactoryResolver,\n              dynForm: DynamicFormComponent<any>) {\n    super(cfr, dynForm);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/@tdm/ngx-dynamic-forms/src/dynamic-forms/dynamic-form-array.component.ts","import { FormGroup } from '@angular/forms';\nimport {\n  targetStore,\n  isString,\n  isNumber,\n  Constructor,\n  PlainObjectMapper,\n  TargetMetadata\n} from '@tdm/core/tdm';\n\nimport { DeserializableForm, NgFormsSerializeMapper, NgFormsDeserializeMapper } from './angular-forms-mapper';\nimport { FormPropMetadata } from './metadata/index';\n\n/**\n * A FormGroup/FormArray deserializer bound to a specific instance.\n *\n */\nclass NgFormsBoundDeserializeMapper extends NgFormsDeserializeMapper {\n\n  constructor(public formGroup: DeserializableForm,\n              sourceType: any,\n              public instance: any,\n              plainMapper?: PlainObjectMapper) {\n    super(formGroup, sourceType, plainMapper);\n  }\n\n  /**\n   * Overrides the base class method to set the result from the instance when `resultOrKey` is a string or a number.\n   * Note that it will set the result from the root object, which means that only 1st level properties can be used and\n   * deep references to nested object are not supported.\n   * This should have no effect since the base implementation of `deserializeFlattened`, when calling itself, provides\n   * the `resultOrKey`\n   */\n  protected deserializeFlattened(control: DeserializableForm,\n                                 formProp: FormPropMetadata,\n                                 resultOrKey?: string | number | any): any {\n    if (isString(resultOrKey) || isNumber(resultOrKey)) {\n      resultOrKey = this.instance[resultOrKey];\n    }\n    return super.deserializeFlattened(control, formProp, resultOrKey);\n  }\n}\n\n/**\n * An instance of NgFormsSerializeMapper and NgFormsDeserializeMapper bound to the same type & instance.\n * This is a helper class for easy form management where one can use the same object to serialize\n * and deserialize the model while keeping a reference to the model data.\n */\n// tslint:disable-next-line\nexport class NgFormsBoundMapper<T> {\n  private fg: FormGroup;\n  private meta: TargetMetadata;\n\n  constructor(private readonly type: Constructor<any>, public readonly instance: T, formGroup?: FormGroup) {\n    this.meta = targetStore.getTargetMeta(type);\n    if (formGroup) {\n      this.fg = formGroup;\n    }\n  }\n\n  serialize(): FormGroup {\n    return this.fg = this.meta.serialize(new NgFormsSerializeMapper(this.instance));\n  }\n\n  deserialize(): T {\n    this.meta.deserialize(new NgFormsBoundDeserializeMapper(this.fg, this.type, this.instance), this.instance);\n    return this.instance;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/@tdm/ngx-dynamic-forms/src/core/ng-forms-bound-mapper.ts","import { NgFormsSerializeMapper } from './core/angular-forms-mapper';\n\n/**\n * Run-time path and Static path are different in how they express arrays.\n * A run-time path will express an array index because it refers to instances.\n * A static path will not express an array index because it refer to types, complex or primitive but an array in the\n * static world is only a container of types (Array of T) and does not play a role in static type lookup.\n *\n * ## Example\n * A User class with an info property, info is an object with a name property (string) and an addresses property\n * which is array of address objects. address objects have a street property (string).\n *\n * Run-time path expressions:\n *  1. info.name\n *  2. info.addresses\n *  3. info.addresses.0.street\n *\n * Static path expressions:\n *  1. info.name\n *  2. info.addresses\n *  3. info.addresses.street\n *\n * Only 3 is different since it's an array.\n *\n * Run-time path expressions is used with runtime instance of form controls, static path expressions are used when\n * working with @tdm metadata and it's form serializers and deserializers.\n */\n\n/**\n * Creates a form control based on metadata of a given property in a given model.\n * If a value is provided the form control will be populated with the value.\n *\n * You can provide a string (`prop`) representing the property name, OR if you want to create a control for a property\n * in a nested object (Only for `@FormProp` declarations with `flatten` expressions OR `childForm` set to true) you\n * you can provide a tuple a tuple with 2 values the first value is a string representing the\n * property name at the root level (exposed property that `@FormProp` decorates), the second value is a dot notation\n * path to the nested property within the flatten expression / Child model.\n *\n * For example, in the following flatten expression:\n *\n * ```ts\n * @FormProp({\n *   flatten: Object.assign({}, basicFlatten, {\n *     additional: {\n *       flatten: {\n *         work: { }\n *       }\n *     }\n *   })\n * })\n * myProp: any;\n * ```\n * If we want to get the control for `work` the path will be: ` ['myProp', 'additional.work'] `\n *\n * > When using a deep path and providing a `value`, the value should be the value to be assign at the resolved path\n * and not the root value, i.e. the value is not evaluated with each step in the path.\n *\n * NOTE: Array's are NOT SUPPORTED by design.\n * This function DOES NOT support arrays, if a given property is an Array<T> the returned form will be T.\n * Make sure not to send an array instance with `value`.\n *\n * Why?\n * The purpose of this function is to create form controls to be added to FormArrays.\n * These can be empty controls or populated with a given `value`.\n * To support all features (e.g. \"flatten\") and allow empty form controls array are not supported because a property\n * with type Array<T> and no values in the array will return an empty FormArray.\n *\n * If you want to create a FormArray control simple call createControl for each item in the array and add it to the\n * FormArray:\n *\n * ```ts\n * new FormArray(items.map( item => createControl(MyType, 'myProp', item) ));\n * ```\n */\nexport const createControl = NgFormsSerializeMapper.createControl;\nexport type createControl = typeof NgFormsSerializeMapper.createControl;\n\n\n\n// WEBPACK FOOTER //\n// ./src/@tdm/ngx-dynamic-forms/src/create-control.ts","import { targetStore, MapExt, Constructor, MetaClass, MetaClassInstanceDetails } from '@tdm/core/tdm';\nimport {\n  FormModelMetadata,\n  FormModelMetadataArgs,\n  FormPropMetadata,\n  FormPropMetadataArgs // leave for angular AOT compiler.\n} from './metadata/index';\nimport { FormElementType } from '../interfaces';\n\n/** @internal */\nexport let formModel: any = {};\nformModel = MetaClass.decorator(FormModelMetadata, true);\n\n/**\n * @propertyDecorator static\n * @param metaArgs\n */\nexport function FormModel(metaArgs?: FormModelMetadataArgs): (target: Function) => any {\n  return formModel(metaArgs) as any;\n}\n\n// we need to export `FormProp` explicitly or else the type of the parameter \"def\" in the \"d.ts\" file will be set\n// to FormModelMetadataArgs<\"form\" | \"none\">\nexport let formProp: any = {};\nformProp = MetaClass.decorator(FormPropMetadata);\n\nexport function FormProp(def: FormPropMetadataArgs): (target: Object, key: TdmPropertyKey) => any {\n  return formProp(def) as any;\n}\n\ntargetStore.on\n  .processType((target: Constructor<any>) => {\n    const tMeta = targetStore.getTargetMeta(target);\n    const modelProps = tMeta.getMetaFor(FormPropMetadata);\n    if (modelProps) {\n      let formModelMeta = tMeta.getMetaFor(FormModelMetadata, true);\n      if (!formModelMeta) {\n        FormModel()(target);\n        formModelMeta = tMeta.getMetaFor(FormModelMetadata, true);\n      }\n\n      MapExt.asKeyValArray(modelProps)\n        .forEach(([k, v]) => formModelMeta.addProp(tMeta.getCreateProp(k as any), v) );\n    }\n  });\n\n\n\n// WEBPACK FOOTER //\n// ./src/@tdm/ngx-dynamic-forms/src/core/decorators.ts","<div class=\"tdm-toc-container\">\n  <div *ngIf=\"linksChanged | async as links\" class=\"tdm-toc-inner\">\n    <div *ngIf=\"tocArea.tocTitle\" class=\"tdm-toc-heading\">{{ tocArea.tocTitle }}</div>\n    <ul class=\"tdm-toc-list\">\n      <li *ngFor=\"let l of links; let i = index\"\n          class=\"tdm-toc-link tdm-toc-level-{{l.link.level}}\"\n          [class.active]=\"l === activeLink\">\n        <ng-container *ngTemplateOutlet=\"linkTemplate || defaultLinkTemplate; context: { $implicit: { rootUrl: rootUrl, link: l.link } }\"></ng-container>\n      </li>\n    </ul>\n  </div>\n</div>\n<ng-template #defaultLinkTemplate let-ctx>\n  <a [href]=\"'#' + ctx.rootUrl + '#' + ctx.link.id\">{{ ctx.link.name }}</a>\n</ng-template>\n\n\n\n// WEBPACK FOOTER //\n// ./src/demo/modules/@shared/toc/toc.component.html","<ng-content></ng-content>\n\n\n// WEBPACK FOOTER //\n// ./node_modules/@angular/material/sidenav/typings/index.d.ts.MatDrawerContent.html","<ng-content></ng-content>\n\n\n// WEBPACK FOOTER //\n// ./node_modules/@angular/material/sidenav/typings/index.d.ts.MatDrawer.html","<div class=\"mat-drawer-backdrop\" (click)=\"_onBackdropClicked()\" [class.mat-drawer-shown]=\"_isShowingBackdrop()\"></div><ng-content select=\"mat-drawer\"></ng-content><ng-content select=\"mat-drawer-content\"></ng-content><mat-drawer-content *ngIf=\"!_content\" cdkScrollable><ng-content></ng-content></mat-drawer-content>\n\n\n// WEBPACK FOOTER //\n// ./node_modules/@angular/material/sidenav/typings/index.d.ts.MatDrawerContainer.html","<ng-content></ng-content>\n\n\n// WEBPACK FOOTER //\n// ./node_modules/@angular/material/sidenav/typings/index.d.ts.MatSidenavContent.html","<ng-content></ng-content>\n\n\n// WEBPACK FOOTER //\n// ./node_modules/@angular/material/sidenav/typings/index.d.ts.MatSidenav.html","<div class=\"mat-drawer-backdrop\" (click)=\"_onBackdropClicked()\" [class.mat-drawer-shown]=\"_isShowingBackdrop()\"></div><ng-content select=\"mat-sidenav\"></ng-content><ng-content select=\"mat-sidenav-content\"></ng-content><mat-sidenav-content *ngIf=\"!_content\" cdkScrollable><ng-content></ng-content></mat-sidenav-content>\n\n\n// WEBPACK FOOTER //\n// ./node_modules/@angular/material/sidenav/typings/index.d.ts.MatSidenavContainer.html","import { ValidatorFn, AsyncValidatorFn } from '@angular/forms';\nimport { MetaClass, PropMetadata, ModelMetadata, BaseMetadata, DecoratorInfo, stringify, isJsObject } from '@tdm/core/tdm';\n\nimport { FormPropMetadata } from './form-prop';\n\nexport interface FormModelMetadataArgs {\n  validator?: ValidatorFn;\n  asyncValidator?: AsyncValidatorFn;\n}\n\n@MetaClass<FormModelMetadataArgs, FormModelMetadata>({\n  single: true,\n  allowOn: ['class'],\n  proxy: {\n    host: ModelMetadata,\n    containerKey: 'form'\n  }\n})\nexport class FormModelMetadata extends BaseMetadata implements FormModelMetadataArgs {\n  validator: ValidatorFn | null;\n  asyncValidator: AsyncValidatorFn | null;\n  props = new Map<string, FormPropMetadata>();\n\n  constructor(metaArgs: FormModelMetadataArgs | undefined, info: DecoratorInfo) {\n    super(info);\n\n    if (isJsObject(metaArgs)) {\n      this.validator = metaArgs.validator || null;\n      this.asyncValidator = metaArgs.asyncValidator || null;\n    }\n  }\n\n  addProp(prop: PropMetadata, metaArgs: FormPropMetadata) {\n    this.props.set(prop.name as any, metaArgs);\n  }\n\n  getProp(propertyKey: string): FormPropMetadata | undefined {\n    return this.props.get(propertyKey);\n  }\n}\n\ndeclare module '@tdm/core/tdm/src/metadata/model-metadata' {\n  interface ModelMetadataArgs {\n    form?: FormModelMetadataArgs | undefined | true;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/@tdm/ngx-dynamic-forms/src/core/metadata/form-model.ts","import {\n  Directive,\n  Input,\n  forwardRef,\n  ViewContainerRef,\n  ComponentFactoryResolver,\n  ComponentRef,\n  Inject,\n  Injector\n} from '@angular/core';\n\nimport { DynamicControlRenderContext, RenderInstruction } from '../tdm-model-form/index';\nimport { DynamicFormComponent } from './dynamic-form.component';\n\n/**\n * An container/wrapper used to project the user-define renderer.\n * DynamicFormControlDirective is much like `NgComponentOutlet`, they both do the same job.\n *\n * DynamicFormControlDirective is more specific to the use case, it accepts {@link RenderInstruction}\n * as input and renders a component that it get's from the DI.\n * @internal\n */\n@Directive({\n  selector: '[dynamicFormControl]'\n})\nexport class DynamicFormControlDirective {\n\n  get dynamicFormControl(): RenderInstruction {\n    return this.render;\n  }\n\n  @Input() set dynamicFormControl(value: RenderInstruction) {\n    if (this.render === value) {\n      return;\n    }\n    this.render = value;\n\n    this.vcRef.clear();\n    const outlet = this.dynForm.getOutlet(value);\n    this.vcRef = outlet ? outlet._vcRef : this.defaultVCRef;\n    this.vcRef.clear();\n\n    if (outlet && outlet._tRef) {\n      this.defaultVCRef.clear();\n      const $implicit: DynamicControlRenderContext  = <any> {};\n      this.dynForm.tdmForm.bindRenderingData($implicit, value);\n      this.defaultVCRef.createEmbeddedView(outlet._tRef, { $implicit } );\n    }\n\n    if (value) {\n      const override = this.dynForm.getOverride(value);\n      if (override) {\n        const $implicit: DynamicControlRenderContext  = <any> {};\n        this.dynForm.tdmForm.bindRenderingData($implicit, value);\n        this.vcRef.createEmbeddedView(override.template, { $implicit } );\n      } else {\n        const injector = this.defaultVCRef.injector;\n        const resolver = injector.get(ComponentFactoryResolver);\n        const component = this.dynForm.getComponentRenderer(value);\n        const componentFactory = resolver.resolveComponentFactory(component);\n        this.cmpRef = this.defaultVCRef.createComponent<DynamicControlRenderContext> (\n          componentFactory,\n          this.defaultVCRef.length,\n          injector\n        );\n        this.dynForm.tdmForm.bindRenderingData(this.cmpRef.instance, value);\n        if (typeof this.cmpRef.instance.tdmOnControlContextInit === 'function') {\n          this.cmpRef.instance.tdmOnControlContextInit();\n        }\n        if (outlet) {\n          this.cmpRef.hostView.detectChanges();\n          this.vcRef.insert(this.defaultVCRef.detach());\n        }\n      }\n    }\n  }\n\n  private render: RenderInstruction;\n  private cmpRef: ComponentRef<DynamicControlRenderContext>;\n  private vcRef: ViewContainerRef;\n\n  constructor(private defaultVCRef: ViewContainerRef,\n              @Inject(forwardRef(() => DynamicFormComponent)) public dynForm: DynamicFormComponent<any>) { // tslint:disable-line\n    this.vcRef = defaultVCRef;\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/@tdm/ngx-dynamic-forms/src/dynamic-forms/dynamic-form-control.directive.ts","import {\n  Directive, Input, OnChanges, OnDestroy, Optional, SimpleChanges, TemplateRef,\n  ViewContainerRef\n} from '@angular/core';\n\nimport { FormElementType } from '../interfaces';\nimport { DynamicFormComponent } from './dynamic-form.component';\nimport { DynamicFormOverrideContext, ControlSelectorBase } from './dynamic-form-override.directive';\n\n@Directive({\n  selector: '[dynamicControlOutlet]',\n  exportAs: 'dynamicControlOutlet',\n})\nexport class DynamicControlOutletDirective extends ControlSelectorBase implements OnChanges, OnDestroy {\n\n  // tslint:disable\n  @Input('dynamicControlOutlet') controlName: string | string[];\n  @Input('dynamicControlOutletDynForm') dynForm: DynamicFormComponent;\n  @Input('dynamicControlOutletVType') vType: keyof FormElementType | Array<keyof FormElementType>;\n  // tslint:enable\n\n  /**\n   * @internal\n   */\n  _vcRef: ViewContainerRef;\n  _tRef?: TemplateRef<DynamicFormOverrideContext>;\n\n  constructor(vcRef: ViewContainerRef, @Optional() tRef: TemplateRef<DynamicFormOverrideContext>) {\n    super();\n    this._vcRef = vcRef;\n    this._tRef = tRef;\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    super.ngOnChanges(changes);\n    if ('dynForm' in changes) {\n      if (changes.dynForm.previousValue) {\n        this.dynForm.detachControlOutlet(this);\n      }\n      if (this.dynForm) {\n        this.dynForm.attachControlOutlet(this);\n      }\n    }\n  }\n\n  ngOnDestroy(): void {\n    if (this.dynForm) {\n      this.dynForm.detachControlOutlet(this);\n    }\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/@tdm/ngx-dynamic-forms/src/dynamic-forms/dynamic-control-outlet.directive.ts","import { Observable } from 'rxjs/Observable';\nimport { BehaviorSubject } from 'rxjs/BehaviorSubject';\nimport { Subscription } from 'rxjs/Subscription';\nimport { toPromise } from 'rxjs/operator/toPromise';\nimport { filter } from 'rxjs/operators';\n\nimport {\n  Component,\n  Input,\n  Inject,\n  EventEmitter,\n  Output,\n  ContentChildren,\n  QueryList,\n  AfterContentInit,\n  OnDestroy,\n  Type,\n  TemplateRef,\n  IterableChanges,\n  IterableDiffer,\n  IterableDiffers,\n  KeyValueDiffer,\n  KeyValueDiffers,\n  KeyValueChangeRecord,\n  ElementRef,\n  ViewChild, Renderer2, AfterViewInit, DoCheck, OnChanges, SimpleChanges, SimpleChange\n} from '@angular/core';\nimport { AbstractControl, FormGroup } from '@angular/forms';\n\nimport { isFunction } from '@tdm/core/tdm';\nimport { FormElementType } from '../interfaces';\nimport { FORM_CONTROL_COMPONENT, ControlRenderer, DefaultRenderer, DefaultRendererMap } from '../default-renderer';\nimport { TDMModelForm, TDMModelFormService, RenderInstruction } from '../tdm-model-form/index';\nimport { PropNotifyHandler, PropChanges } from '../prop-notify';\nimport { coerceBooleanProperty } from '../utils';\nimport { DynamicFormOverrideDirective, DynamicFormOverrideContext } from './dynamic-form-override.directive';\nimport { DynamicControlOutletDirective } from './dynamic-control-outlet.directive';\nimport { BeforeRenderEventHandler } from './before-render-event-handler';\nimport { RendererEvent } from './renderer-event';\n\nexport interface LocalRenderInstruction extends RenderInstruction {\n  /**\n   * Used as flag for show/hide (true is hide)\n   * @internal\n   */\n  _dSelf: boolean;\n  /**\n   * Used as flag for show/hide of parent (true is hide)\n   * @internal\n   */\n  _dParent: boolean;\n}\n\n/**\n * Represents a single change in a form.\n * This type is an alias of KeyValueChangeRecord<string, any>\n */\nexport interface TdmFormChange extends KeyValueChangeRecord<string, any> {\n  /**\n   * When true indicates that the `key` property contains a path and not a name, i.e it's a dot delimited path to a\n   * property through nested object (or objects)\n   */\n  deep?: boolean;\n}\n\n/**\n * Represents a collection of changes in a form\n * This type is an alias of Array<KeyValueChangeRecord<string, any>> (TdmFormChange[])\n */\nexport type TdmFormChanges = TdmFormChange[];\n\ntype StateKeys = 'filter' | 'disabled' | 'hidden';\n\n/**\n * Allow rendering a form using @tdm/ngx-dynamic-forms and MaterialFormControlRenderer\n */\n@Component({\n  selector: 'dynamic-form',\n  templateUrl: './dynamic-form.component.html'\n})\nexport class DynamicFormComponent<T = any>\n  implements PropNotifyHandler, AfterContentInit, AfterViewInit, OnChanges, DoCheck, OnDestroy {\n\n  /**\n   * The [[TDMModelForm]] instance that is used by the component\n   * > This is created after a model is set.\n   */\n  tdmForm: TDMModelForm<any>;\n\n  /**\n   * The [[FormGroup]] instance used by [[TDMModelForm]].\n   * Available after [[TDMModelForm]] instance is created.\n   */\n  get form(): FormGroup | undefined {\n    return this.tdmForm && this.tdmForm.form;\n  }\n\n  @ContentChildren(DynamicFormOverrideDirective) overrides: QueryList<DynamicFormOverrideDirective>;\n\n  @ViewChild('formElRef') formElRef: ElementRef;\n\n  /**\n   * Real time binding between the form and the model.\n   *\n   * When true, every value change event emitted from the from will trigger and update to the model.\n   *\n   * When false (default) the form data model and the model instance are not bound, to update the model\n   * you need to invoke the TDMModelForm.commitToModel\n   *\n   * > A hot bind is one way, from form update to the model.\n   *\n   * @default false\n   */\n  @Input() hotBind: boolean;\n\n  @Input() disabled: boolean;\n\n  /**\n   * Pass through for @angular/forms `ngNativeValidate` attribute that enables native browser validation\n   *\n   */\n  @Input()\n  get ngNativeValidate(): any {\n    return this._ngNativeValidate;\n  };\n\n  set ngNativeValidate(value: any) { // tslint:disable-line\n    const native = value != null && `${value}` !== 'false';\n    if ( this._ngNativeValidate !== native ) {\n      this._ngNativeValidate = native;\n      this.setNativeValidation();\n    }\n  };\n\n  /**\n   * The instance and type (class) to dynamically render as form.\n   * You can set the model using 3 possible formats:\n   *   1. The model's instance, in this case the type is the constructor property (instance.constructor)\n   *   2. A tuple of [Model Instance, Model Type]\n   *   3. An instance of [[TDMModelForm]], the model an type are taken from [[TDMModelForm]], the component will not\n   *   create anew instance of [[TDMModelForm]] and will use the one provided.\n   *   Setting this value is only possible when a previous TDMModelForm is not set.\n   *\n   * @example\n   * `<dynamic-form [model]=\"user\"></dynamic-form>`\n   * `<dynamic-form [model]=\"[user, User]\"></dynamic-form>`\n   *\n   */\n  @Input() model: T | TDMModelForm<T> | [ T, Type<T> ];\n\n  /**\n   * Setting the dynamic form as a slave of another dynamic form.\n   * You can this feature to split forms of complex models.\n   *\n   * A form in slave mode has very limited functionality, it can only filter controls and override controls.\n   * All other options (hidden state, disabled state, hot binding etc..) are not supported in the slave and should be\n   * handled in the master.\n   *\n   * Make sure you are not rendering the same controls more then once. A group of master and all of it's slave should\n   * render only one instance of a control across the whole group. If you render the same control multiple times\n   * you will get unexpected behaviour and unsynced controls.\n   *\n   * You can set any number of slaves.\n   * You can not change or remove the master.\n   * You can not set a model when using slave mode.\n   *\n   * A slave does not handle form state, it only handles internal rendering and this is why only filter and\n   * override are supported, hidden and disabled are drived by the form state...\n   * @param dynForm\n   */\n  @Input()\n  set slaveOf(dynForm: DynamicFormComponent<T>) {\n    if ( this.slaveMode === true ) {\n      return; // TODO: warn? error? slave mode can only be set once.\n    } else if ( this.slaveMode === false ) {\n      throw new Error('Slave mode does not work when setting a model');\n    }\n    this.tdmForm = dynForm.tdmForm;\n    this.instance = dynForm.instance;\n    this.type = dynForm.type;\n    this.slaveMode = true;\n    this.rendererEvent$.subscribe(e => dynForm.rendererEvent$.emit(e));\n  }\n\n  /**\n   * An array of form control names, each name in this array will used when filtering the controls.\n   *\n   * The filter operation is set by the `filterMode` property.\n   *\n   * When the filter mode is \"exclude\" all fields are rendered by default but each name in this array will not be\n   * rendered (excluded).\n   *\n   * When the filter mode is \"include\" all fields are not rendered by default but each name in this array will be\n   * rendered (included).\n   *\n   * The default filtering mode is `exclude`\n   *\n   * Supports deep paths using dot notation.\n   * The end result in the UI is identical to `hiddenState` however excluded fields behave like `*ngIf`, they are never\n   * rendered, hidden fields are rendered but not displayed.\n   */\n  @Input() filter: string[];\n\n  /**\n   * Defines the filtering mode.\n   *\n   * There are 2 modes:\n   *   - include: All fields will not render by default, only those defined in the filter will render.\n   *   - exclude: All fields will render by default, only those defined in the filter will not render.\n   *\n   * The default filtering mode is `exclude`\n   */\n  @Input() filterMode: 'include' | 'exclude' = 'exclude';\n\n  /**\n   * An array of form control names, each name in this array will be disabled.\n   * Supports deep paths using dot notation.\n   */\n  @Input() disabledState: string[];\n\n  /**\n   * An array of form control names, each name in this array will be hidden (display: none).\n   * Supports deep paths using dot notation.\n   *\n   * From the UI perspective, the end result for `filter` and `hiddenState` is identical, however there is a difference.\n   * Fields filtered out by `filter` are similar to `*ngIf`, they are added / removed when toggled. Hidden fields are\n   * rendered but does not displayed. This has an effect on performance, animation, etc...\n   */\n  @Input() hiddenState: string[];\n\n  /**\n   * Event emitted when a form value changes.\n   *\n   * When a change occurs in a child property of a flattened property (nested objects) the `key` property in the change\n   * represents a path (not the name) to the value from the root object.\n   *\n   * > Note that each event is emitted synchronously and all listeners will run in sequence. While listeners run new\n   * change events are blocked which means you can change form values without the event firing again. If you do want\n   * a re-fire change the value async.\n   */\n  @Output() valueChanges = new EventEmitter<TdmFormChanges>();\n\n  /**\n   * Event emitted before rendering form controls.\n   *\n   * Only included controls are emitted.\n   *\n   * Use this event to modify form control/s rendering instructions (metadata) before they are rendered.\n   * For example, given a `select` form control, you can use this event to create dynamic, ad-hoc, select options.\n   *\n   * ```html\n   *  <dynamic-form [model]=\"model\" (beforeRender)=\"beforeRender($event)\">\n   * ```\n   *\n   * ```ts\n   * @Component({ ... })\n   * export class MyComponent {\n   *   beforeRender(event: BeforeRenderEventHandler) {\n   *     if ('state' in event.instructions) {\n   *       event.instructions.state.options = [ { value: 'X', label: 'Y' } ] // more...\n   *     }\n   *   }\n   * }\n   * ```\n   * You can modify all the of properties in {@link RenderInstruction}... the render type, order and more.\n   *\n   * ### Asynchronous rendering logic\n   * There are scenarios where the modification logic is asynchronous, for example, populating the\n   * options (options) of a form control from a remote server\n   *\n   * ```ts\n   * @Component({ ... })\n   * export class MyComponent {\n   *   beforeRender(event: BeforeRenderEventHandler) {\n   *     if ('state' in event.instructions) {\n   *       let resolve, p = new Promise( (res, rej) => { resolve = res; });\n   *\n   *       event.async(p); // notify to use async logic\n   *\n   *       // do some async stuff...\n   *       setTimeout(() => {\n   *         event.instructions.state.options = [ { value: 'X', label: 'Y' } ] // more...\n   *         resolve();\n   *       }, 1000);\n   *     }\n   *   }\n   * }\n   * ```\n   * > You can use the `renderState` event to reflect asynchronous rendering in the UI.\n   */\n  @Output() beforeRender = new EventEmitter<BeforeRenderEventHandler>();\n\n  /**\n   * Event emitted when the rendering state changes.\n   * True states that the form is rendering, False states and idle, the form is rendered.\n   *\n   * Since rendering in angular is synchronous a True rendering state can only occur when implementing\n   * async logic within `beforeRender` event {@link BeforeRenderEventHandler}\n   *\n   * Use this event to reflect (UX/UI) in that the form is not ready.\n   */\n  @Output() renderState: Observable<boolean>;\n\n  /**\n   * An notification stream dedicated to the renderer.\n   *\n   * A renderer implementation can use this stream to emit notification to the host of a dynamic form.\n   *\n   * For example, instead of a child form being displayed by the renderer the renderer can emit a\n   * [[ChildFormEditRendererEvent]] event and let the host display the child form.\n   *\n   * There are several fixed event and a custom event, see [[RendererEvent]] for more details.\n   */\n  @Output() rendererEvent: Observable<RendererEvent>;\n\n  /**\n   * The active render instructions for this instance, active instructions does not include instruction that were\n   * filtered out.\n   */\n  instructions: { [path: string]: RenderInstruction } = {};\n\n  /**\n   * The active render instructions for this instance, active instructions does not include instruction that were\n   * filtered out.\n   * @internal\n   */\n  controls = new BehaviorSubject<LocalRenderInstruction[]>([]);\n\n  private instance: T;\n  private type: Type<T>;\n  private subscriptions: Subscription[] = [];\n  private freezeValueChanges: boolean;\n  private valueDiffer: KeyValueDiffer<string, any>;\n  private stateDiffer: Partial<Record<StateKeys, IterableDiffer<string>>> = {};\n  private afterInit: boolean;\n  private rendering$ = new BehaviorSubject<boolean>(false);\n  private _ngNativeValidate: any = false;\n  private slaveMode: boolean;\n  private outlets: Set<DynamicControlOutletDirective> = new Set<DynamicControlOutletDirective>();\n  private overrideMap = new Map<RenderInstruction, DynamicFormOverrideDirective>();\n  private outletMap = new Map<RenderInstruction, DynamicControlOutletDirective>();\n  private wildOverride: DynamicFormOverrideDirective;\n  private rendererEvent$ = new EventEmitter<RendererEvent>();\n  private renderInstructions: RenderInstruction[];\n\n  private controlRenderer: DefaultRendererMap;\n  private defaultControlRenderer: ControlRenderer;\n\n  /**\n   * Indicates the number of update() calls that are running/queued\n   * A number n that is > 1 does not mean the update will run n times, it will run one more time only.\n   */\n  private pendingUpdates: number = 0;\n  /**\n   * Overrides that are injected by code (addOverride) and not by content projection\n   */\n  private codeOverrides: DynamicFormOverrideDirective[] = [];\n\n  constructor(private tdmModelFormService: TDMModelFormService,\n              @Inject(FORM_CONTROL_COMPONENT) controlRenderer: DefaultRenderer,\n              private kvDiffers: KeyValueDiffers,\n              private itDiffers: IterableDiffers,\n              private renderer: Renderer2) {\n    this.renderState = this.rendering$.asObservable();\n    this.rendererEvent = this.rendererEvent$.asObservable();\n\n    if ( isFunction(controlRenderer) ) {\n      this.controlRenderer = {};\n      this.defaultControlRenderer = controlRenderer;\n    } else {\n      this.controlRenderer = controlRenderer;\n      this.defaultControlRenderer = this.controlRenderer[ '*' ];\n      if ( !this.defaultControlRenderer ) {\n        throw new Error('Default control renderer not set.');\n      }\n    }\n  }\n\n  getComponentRenderer(rd: RenderInstruction): ControlRenderer {\n    return rd.isArray\n      ? this.controlRenderer[ '[]' ] || this.defaultControlRenderer\n      : this.controlRenderer[ rd.vType ] || this.defaultControlRenderer\n      ;\n  }\n\n  attachControlOutlet(outlet: DynamicControlOutletDirective): void {\n    this.outlets.add(outlet);\n  }\n\n  detachControlOutlet(outlet: DynamicControlOutletDirective): boolean {\n    return this.outlets.delete(outlet);\n  }\n\n  /**\n   * Redraw the controls of the form.\n   * This will fire the (renderState) event and trigger (beforeRender) event's for each render instruction.\n   *\n   * If you wish to invoke a silent update call the markAsChanged() method on a [[RenderInstruction]] instance, this\n   * will mark it for change detection but will not fire the events.\n   */\n  redraw(): void;\n  redraw(returnPromise: boolean): Promise<void>;\n  redraw(returnPromise?: boolean): Promise<void> | void {\n    this.update();\n    if ( returnPromise === true ) {\n      if ( this.rendering$.getValue() === false ) {\n        return Promise.resolve();\n      } else {\n        return toPromise.call(this.renderState.pipe(\n          filter(state => !state)\n        ));\n      }\n    }\n  }\n\n  getOverride(item: RenderInstruction): DynamicFormOverrideDirective | undefined {\n    return this.overrideMap.get(item);\n  }\n\n  getOutlet(item: RenderInstruction): DynamicControlOutletDirective | undefined {\n    return this.outletMap.get(item);\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if ( changes.model ) {\n      this.onModelChange();\n    }\n\n    if ( changes.hotBind ) {\n      this.hotBind = coerceBooleanProperty(this.hotBind);\n    }\n\n    if ( changes.disabled ) {\n      this.disabled = coerceBooleanProperty(this.disabled);\n      this.onDisableChange();\n    }\n\n    if ( changes.filterMode ) {\n      const prevIncluded = changes.filterMode.previousValue === 'include';\n      const currIncluded = changes.filterMode.currentValue === 'include';\n      if ( currIncluded !== prevIncluded ) {\n        this.update();\n      }\n    }\n\n    if ( changes.filter ) {\n      this.onStateChange('filter', changes.filter);\n    }\n\n    if ( changes.disabledState ) {\n      this.onStateChange('disabled', changes.disabledState);\n    }\n\n    if ( changes.hiddenState ) {\n      this.onStateChange('hidden', changes.hiddenState);\n    }\n  }\n\n  ngDoCheck() {\n    if ( this.filter && this.stateDiffer.filter ) {\n      const diff = this.stateDiffer.filter.diff(this.filter);\n      if ( diff ) {\n        this.handleDiff('filter', diff);\n      }\n    }\n\n    if ( this.disabledState && this.stateDiffer.disabled ) {\n      const diff = this.stateDiffer.disabled.diff(this.disabledState);\n      if ( diff ) {\n        this.handleDiff('disabled', diff);\n      }\n    }\n\n    if ( this.hiddenState && this.stateDiffer.hidden ) {\n      const diff = this.stateDiffer.hidden.diff(this.hiddenState);\n      if ( diff ) {\n        this.handleDiff('hidden', diff);\n      }\n    }\n  }\n\n  ngAfterContentInit(): void {\n    this.renderInstructions = this.tdmForm.renderData;\n\n    this.afterInit = true;\n    this.updateOverrides();\n\n    const s = this.overrides.changes.subscribe(() => this.updateOverrides());\n    this.subscriptions.push(s);\n  }\n\n  ngAfterViewInit(): void {\n    if ( this._ngNativeValidate === true ) {\n      this.setNativeValidation();\n    }\n  }\n\n  ngOnDestroy(): void {\n    let subs: Subscription;\n    while ( subs = this.subscriptions.pop() ) { // tslint:disable-line\n      subs.unsubscribe();\n    }\n    this.rendererEvent$.complete();\n    this.rendering$.complete();\n    this.beforeRender.complete();\n    this.valueChanges.complete();\n  }\n\n  /**\n   * Returns the form control for a given key\n   * @param key\n   * @returns\n   */\n  getControl(key: string): AbstractControl | null {\n    return this.tdmForm.get(key);\n  }\n\n  /**\n   * API to manually add field override templates, use this if you want to apply overrides but can not\n   * set the content projection in the template.\n   */\n  addOverride(query: { controlName?: string | string[]; vType?: keyof FormElementType | Array<keyof FormElementType> },\n              tRef: TemplateRef<DynamicFormOverrideContext>, update: boolean = true): void {\n    const d = new DynamicFormOverrideDirective(tRef);\n    d.controlName = query.controlName;\n    d.vType = query.vType;\n    d.syncQuery();\n    if ( d.isCatchAll && !d.vType ) {\n      this.wildOverride = d;\n      this.wildOverride[ '__CUSTOM_ADD_OW__' ] = true;\n    } else {\n      this.codeOverrides.push(d);\n    }\n\n    if ( update ) {\n      this.update();\n    }\n  }\n\n  emitRendererEvent(event: RendererEvent): void {\n    this.rendererEvent$.emit(event);\n  }\n\n  onPropChange(ri: RenderInstruction, changes: PropChanges<RenderInstruction>): void {\n    let markAsChanged: boolean;\n    if ( changes.required || changes.validators || changes.asyncValidators ) {\n      const control = this.tdmForm.get(ri.fullName);\n      const validators = ri.getValidators();\n      control.setValidators(validators[ 0 ]);\n      control.setAsyncValidators(validators[ 1 ]);\n      markAsChanged = true;\n    }\n    if ( changes.vType || changes.label ) {\n      markAsChanged = true;\n    }\n    if ( changes.ordinal ) {\n      this.update();\n    }\n    if ( markAsChanged ) {\n      ri.markAsChanged();\n    }\n  }\n\n  private onModelChange(): void {\n    const model = this.model;\n\n    if ( this.slaveMode ) {\n      throw new Error('Setting a model is not allowed when in slave mode.');\n    }\n    this.slaveMode = false;\n\n    if ( model instanceof TDMModelForm ) {\n      if ( this.tdmForm ) {\n        if ( this.tdmForm === model ) {\n          return;\n        } else {\n          throw new Error(\n            'Can not set a model using a TDMModelForm instance when a previous TDMModelForm instance exist'\n          );\n        }\n      }\n      this.instance = model.model;\n      this.type = model.type;\n    } else if ( Array.isArray(model) ) {\n      this.instance = model[ 0 ];\n      this.type = model[ 1 ];\n    } else {\n      this.instance = model;\n      this.type = <any> model.constructor;\n    }\n\n    this.valueDiffer = undefined;\n\n    if ( !this.tdmForm ) {\n      this.tdmForm = model instanceof TDMModelForm\n        ? model\n        : this.tdmModelFormService.create(this.instance, this.type)\n      ;\n\n      const formValue = this.tdmForm.form.getRawValue();\n      this.valueDiffer = this.kvDiffers.find(formValue).create();\n      this.valueDiffer.diff(formValue); // for some reason objects do not commit the 1st time\n      if ( this.disabled ) {\n        this.form.disable();\n      }\n      this.applyFormListener();\n    } else {\n      this.tdmForm.setContext(this.instance, this.type);\n    }\n    this.update();\n  }\n\n  private onDisableChange(): void {\n    if ( this.form ) {\n      if ( this.disabled ) {\n        this.form.disable();\n      } else {\n        this.form.enable();\n      }\n    }\n  }\n\n  private updateOverrides(): void {\n    const match = this.overrides.find(ow => ow.isCatchAll && !ow.vType);\n    // we update the wildOverride, but we check if the old wildOverride was added using addOverride method (custom)\n    // if so (no match and old added manually) we will leave it.\n    // we do that because it's most likely we won't find template overrides when custom is set\n    // it also means template wins over custom\n    if ( match || !this.wildOverride || this.wildOverride[ '__CUSTOM_ADD_OW__' ] !== true ) {\n      this.wildOverride = match;\n    }\n\n    this.update();\n  }\n\n  private update(): void {\n    if ( !this.tdmForm || !this.afterInit ) {\n      return;\n    }\n\n    if ( this.pendingUpdates > 0 ) {\n      this.pendingUpdates += 1;\n      return;\n    }\n\n    // we wmit the rendering state async\n    const controlsReady: Array<Promise<any>> = [ new Promise((resolve) => setTimeout(() => {\n      this.emitRenderingState(true);\n      resolve();\n    })) ];\n    const controls: LocalRenderInstruction[] = [];\n    const controlsMap: { [path: string]: RenderInstruction } = this.instructions = {};\n    const controlsPromiseSetter = done => controlsReady.push(done);\n    this.overrideMap.clear();\n    this.outletMap.clear();\n\n    const overrides = this.overrides.toArray().concat(this.codeOverrides);\n    const outlets = Array.from(this.outlets.values());\n    const hiddenState = this.hiddenState && this.hiddenState.slice();\n    const filterMatch = this.filterMode === 'include';\n    const filter = this.filter && this.filter.slice();\n\n    const processInstructions = (rd: LocalRenderInstruction) => {\n      const fullPath: string = rd.fullName;\n      if ( !filter || this.isStaticPathContainsPath(filter, fullPath) === filterMatch ) {\n        const override = overrides.find(o => o.isMatching(rd)) || this.wildOverride;\n        if ( override ) {\n          this.overrideMap.set(rd, override);\n        }\n\n        const outlet = outlets.find(o => o.isMatching(rd));\n        if ( outlet ) {\n          this.outletMap.set(rd, outlet);\n        }\n\n        // update hidden state of each item\n        setHidden(rd, !!( hiddenState && this.isStaticPathContainsPath(hiddenState, fullPath) ));\n        controlsMap[ fullPath ] = rd;\n        controls.push(rd);\n      }\n    };\n\n    this.renderInstructions.forEach(processInstructions);\n\n    const renderEvent = new BeforeRenderEventHandler(controlsMap, controlsPromiseSetter);\n    this.beforeRender.emit(renderEvent);\n\n    this.pendingUpdates += 1;\n    Promise.all(controlsReady)\n    // tslint:disable-next-line\n      .catch(err => {\n      }) // we swallow errors, these should be handled by the user\n      .then(() => {\n        this.pendingUpdates -= 1;\n\n        if ( this.pendingUpdates > 0 ) {\n          this.pendingUpdates = 0;\n          this.update();\n          return;\n        } else {\n          this.instructions = controlsMap;\n          this.controls.next(controls.sort((a, b) => a.ordinal - b.ordinal));\n          this.emitRenderingState(false);\n        }\n      });\n  }\n\n  /**\n   * Check's if an array of paths that might be static or partial are part of the provided full static path.\n   * For example: pathList: ['address'], fullPath: 'address.street' -> true\n   *\n   * TODO: This is called from the update() method and can be improved.\n   * because it use a RenderInstruction it has the full path as an array so we can flag levels so next call to deep\n   * a nested item will fail on the spot cause it's first level was blocked.\n   * e.g. if user blocked 'address' and next item is 'address.name' or 'address.x.y.z' it will fail on the spot because\n   * all of the address object is blocked. Current state is full check for all children of address.\n   */\n  private isStaticPathContainsPath(pathList: string[], fullPath: string): boolean {\n    const idx = pathList.findIndex(p => p === fullPath || fullPath.indexOf(p + '.') === 0);\n    if ( idx > -1 ) {\n      const nextChar = fullPath[ pathList[ idx ].length ];\n      return !nextChar || nextChar === '.';\n    }\n    return false;\n  }\n\n  private emitRenderingState(state: boolean): void {\n    if ( this.rendering$.getValue() === !state ) {\n      this.rendering$.next(state);\n    }\n  }\n\n  private applyFormListener(): void {\n    let freeze: boolean;\n    this.tdmForm.propNotifyHandler = this;\n    const s = this.tdmForm.form.valueChanges.subscribe(formValue => {\n      const diff = this.valueDiffer.diff(formValue);\n      // we diff before freeze check so we won't pile changes to next step.\n      if ( freeze || this.freezeValueChanges ) {\n        return;\n      }\n      if ( diff ) {\n        const arr: TdmFormChanges = [];\n        diff.forEachChangedItem(change => {\n          if ( this.hotBind === true ) {\n            this.instance[ change.key ] = change.currentValue;\n          }\n          if ( this.isFlattenedProp(change.key) ) {\n            arr.push(...this.drillDownChange(change, [ change.key ]));\n          } else {\n            arr.push(change);\n          }\n        });\n        if ( arr.length > 0 ) {\n          freeze = true;\n          this.valueChanges.next(arr);\n          freeze = false;\n        }\n      }\n    });\n    this.subscriptions.push(s);\n  }\n\n  private isFlattenedProp(key: string, level: number = 0): boolean {\n    return this.tdmForm.renderData.some(r => !!r.flattened && r.flattened[ level ] === key);\n  }\n\n  /**\n   * Drills down a change in an object of a `flattened` property and returns the changes in the object.\n   * The drill down is recursive so nested flattened properties will reflect the changes as well.\n   *\n   * The `key` of each change will be in the dot notation format.\n   *\n   * ## Why?\n   * The form `valueChanges` stream will emit changes to controls on the first level, if a nested control\n   * (i.e FormGroup or FormArray) has child that changed the stream will not reflect that and will only emit an event\n   * for the top-level control itself.\n   *\n   * This resolution is an issue when using flattened rendering.\n   * While UI shows a flat form the underlying structure is left intact and each flattened property gets a `FormGroup`\n   * attached to it, emitting [[DynamicFormComponent.valueChanges]] events for flattened properties will have low\n   * resolution because the change event will include the top-level key only and the current/previous values will be\n   * the top-level objects themselves and not the actual child value that changed.\n   *\n   * To enhance the resolution this method will drill down the value of a change to find the internal changes in the\n   * object and return them, this is done by diffing the previous value with the current value.\n   * Each drill down is recursive so a flattened object with a nested flattened object will also get proper resolution.\n   *\n   * You must call this function with a change for a property that is known to be defined as flattened and include\n   * it in the `path` parameter as the first (and only) item.\n   *\n   * > Make sure not to confuse flattened nested objects with nested objects that are not defined as flattened by the\n   * user, those will not apply here.\n   * @param change\n   * @param path\n   */\n  private drillDownChange(change: KeyValueChangeRecord<string, any>,\n                          path: Array<string | number>): Array<KeyValueChangeRecord<string, any>> {\n    const result: Array<KeyValueChangeRecord<string, any>> = [];\n    if ( change.previousValue ) {\n      const differ = this.kvDiffers.find(change.previousValue).create();\n      differ.diff(change.previousValue);\n      const diff = differ.diff(change.currentValue);\n      if ( diff ) {\n        diff.forEachChangedItem((c: any) => {\n          if ( this.isFlattenedProp(c.key, path.length) ) {\n            result.push(...this.drillDownChange(<any> c, path.concat([ c.key ])));\n          } else {\n            c = Object.create(c, { deep: { value: true }, key: { value: path.join('.') + `.${c.key}` } });\n            result.push(c);\n          }\n        });\n      }\n    } else if ( change.currentValue ) {\n      change = Object.create(change, { deep: { value: true }, key: { value: path.join('.') + `.${change.key}` } });\n      result.push(change);\n    }\n    return result;\n  }\n\n  private setNativeValidation(): void {\n    if ( this.formElRef ) {\n      if ( this._ngNativeValidate === true ) {\n        this.renderer.removeAttribute(this.formElRef.nativeElement, 'novalidate');\n      } else {\n        this.renderer.setAttribute(this.formElRef.nativeElement, 'novalidate', '');\n      }\n    }\n  }\n\n  private onStateChange(type: StateKeys, state: SimpleChange): void {\n    let differ: IterableDiffer<string> = this.stateDiffer[ type ];\n    if ( !state.currentValue && differ ) {\n      const diff = differ.diff([]);\n      if ( diff ) {\n        this.handleDiff(type, diff);\n      }\n      differ = undefined;\n    } else if ( !state.previousValue && state.currentValue ) {\n      differ = this.itDiffers.find(state.currentValue).create();\n    }\n    this.stateDiffer[ type ] = differ;\n  }\n\n  private handleDiff(type: StateKeys, diff: IterableChanges<string>): void {\n    switch ( type ) { // tslint:disable-line\n      case 'disabled':\n        this.freezeValueChanges = true;\n        diff.forEachAddedItem(record => this.getControl(record.item).disable());\n        diff.forEachRemovedItem(record => this.getControl(record.item).enable());\n        this.freezeValueChanges = false;\n        break;\n      case 'filter':\n        this.update();\n        break;\n      case 'hidden':\n        diff.forEachAddedItem(record => {\n          const item = this.findRenderInstructionByKey(record.item);\n          if ( item && setHidden(item, true) ) {\n            this.update();\n          }\n        });\n        diff.forEachRemovedItem(record => {\n          const item = this.findRenderInstructionByKey(record.item);\n          if ( item && setHidden(item, false) ) {\n            this.update();\n          }\n        });\n        break;\n    }\n  }\n\n  /**\n   * Find's a RenderInstruction using the provided static property path.\n   * Note that a property path might point to a virtual RenderInstruction, such that does not actually render in the UI\n   * but has children that does.\n   */\n  private findRenderInstructionByKey(dotProperty: string): LocalRenderInstruction | undefined {\n    for ( let c of this.controls.value ) {\n      const fullPath = c.fullName;\n      if ( fullPath.indexOf(dotProperty) > -1 ) {\n        const nextChar = fullPath[ dotProperty.length ];\n        if ( !nextChar ) {\n          return c;\n        } else if ( nextChar === '.' ) {\n          let len = fullPath.substr(dotProperty.length + 1).split('.').length;\n          while ( len-- > 0 ) {\n            c = <any> c.parent;\n          }\n          return c;\n        }\n      }\n    }\n  }\n}\n\n/**\n * Set's the state of the display property in the LocalRenderInstruction.\n * Take's into consideration parent's state when computing the child's state.\n * returns `true` when the operation included changes in children\n */\nfunction setHidden(ri: LocalRenderInstruction, value: boolean): boolean {\n  if ( ri.hidden !== value ) {\n    ri._dSelf = value;\n    ri.hidden = ri._dSelf || ri._dParent;\n    ri.markAsChanged();\n    return tryRunOnChildren(ri, ri._dSelf);\n  }\n  return false;\n}\n\nfunction setHiddenParent(ri: LocalRenderInstruction, value: boolean): void {\n  ri._dParent = value;\n  ri.hidden = ri._dSelf || ri._dParent;\n  ri.markAsChanged();\n  tryRunOnChildren(ri, value);\n}\n\nfunction tryRunOnChildren(ri: LocalRenderInstruction, value: boolean): boolean {\n  const children = ri.isVirtual ? ri.virtualChildren : ri.isArray ? ri.children : undefined;\n  if ( children ) {\n    children.forEach(child => setHiddenParent(<any> child, value));\n    return true;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/@tdm/ngx-dynamic-forms/src/dynamic-forms/dynamic-form.component.ts","<div class=\"markdown-body\" [class.overflow-container]=\"overflowContainer\">\n  <div class=\"markdown-content\" *ngIf=\"markdown\" [innerHtml]=\"markdown\"></div>\n  <pre *ngIf=\"code\" class=\"lang-{{code.lang}}\"><code class=\"lang-{{code.lang}}\" [innerHtml]=\"code.code\"></code></pre>\n  <ng-content></ng-content>\n</div>\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/demo/modules/@shared/components/markdown-view/markdown-view.component.html","<mat-drawer-container autosize=\"autoSize\">\n  <mat-drawer mode=\"side\" opened=\"true\">\n    <mat-nav-list>\n      <ng-container *ngFor=\"let t of tutorialsChanged | async\">\n        <h3 *ngIf=\"t.tutorial.subHeader\" matSubheader>{{t.tutorial.subHeader}}</h3>\n        <a mat-list-item\n           [routerLink]=\"['..', t.tutorial.id]\"\n           routerLinkActive=\"active\">{{t.tutorial.name}}</a>\n      </ng-container>\n    </mat-nav-list>\n  </mat-drawer>\n  <mat-drawer-content>\n    <div class=\"tdm-page\">\n      <div class=\"tdm-page-content\" tdmTocArea #tocArea=\"tocArea\" tdmAnchorTrap>\n        <span #tutorialView></span>\n        <tdm-toc [tocArea]=\"tocArea\">\n          <a *tocLinkTemplate=\"let ctx;\"\n             [routerLink]=\"['./']\"\n             [fragment]=\"ctx.link.id\">{{ ctx.link.name }}</a>\n        </tdm-toc>\n      </div>\n    </div>\n  </mat-drawer-content>\n</mat-drawer-container>\n\n\n\n// WEBPACK FOOTER //\n// ./src/demo/modules/@shared/components/tutorial-page/tutorial-page.component.html","import {\n  ComponentFactoryResolver,\n  Directive,\n  Input,\n  ViewContainerRef,\n  Optional,\n  TemplateRef,\n  SimpleChanges,\n  IterableDiffers,\n  IterableDiffer,\n  TrackByFunction,\n  SimpleChange,\n  OnChanges,\n  IterableChanges,\n  IterableChangeRecord,\n  DoCheck\n} from '@angular/core';\nimport { NgForOf, NgForOfContext } from '@angular/common';\nimport { AbstractControl, FormArray, FormGroup } from '@angular/forms';\n\nimport { TDMModelForm, RenderInstruction, DynamicControlRenderContext } from '../tdm-model-form/index';\nimport { DynamicFormComponent } from './dynamic-form.component';\n\nimport { DynamicFormArray } from './dynamic-form-array.component';\n\nconst forFormArrayContextKeys: Array<keyof ForFormArrayDirective> = [\n  'item',\n  'tdmForm',\n  'fGroup',\n  'dynForm'\n];\n\n@Directive({\n  selector: '[dynamicFormArray]',\n})\nexport class DynamicFormArrayDirective extends DynamicFormArray {\n  // tslint:disable\n  @Input('dynamicFormArrayDynForm') dynForm: DynamicFormComponent;\n  @Input('dynamicFormArrayFArray') fArray: FormArray;\n  @Input('dynamicFormArrayFGroup') fGroup: FormGroup;\n  @Input('dynamicFormArrayItem') item: RenderInstruction;\n  @Input('dynamicFormArrayTdmForm') tdmForm: TDMModelForm<any>;\n  // tslint:enable\n\n  vcRef: ViewContainerRef;\n\n  constructor(vcRef: ViewContainerRef,\n              cfr: ComponentFactoryResolver,\n              dynForm: DynamicFormComponent<any>) {\n    super(cfr, dynForm);\n    this.vcRef = vcRef;\n  }\n}\n\n@Directive({\n  selector: '[forFormArray]',\n})\nexport class ForFormArrayDirective extends NgForOf<DynamicControlRenderContext> implements OnChanges, DoCheck {\n  // tslint:disable\n  @Input('forFormArrayOf') fArray: FormArray;\n  @Input('forFormArrayTrackBy') ngForTrackBy: TrackByFunction<DynamicControlRenderContext>;\n\n  @Input('forFormArrayDynForm') dynForm: DynamicFormComponent;\n  @Input('forFormArrayFGroup') fGroup: FormGroup;\n  @Input('forFormArrayItem') item: RenderInstruction;\n  @Input('forFormArrayTdmForm') tdmForm: TDMModelForm<any>;\n\n  // TODO: warn or throw when setting context after one of the values in the context was set manually\n  @Input('forFormArrayContext') set context(value: DynamicControlRenderContext) {\n    if (value) {\n      for (let k of forFormArrayContextKeys) {\n        this[k] = value[k];\n      }\n    }\n  };\n  // tslint:enable\n\n  private ready: boolean = false;\n  private formArrayDiffer: IterableDiffer<AbstractControl> | null = null;\n  private grouped: DynamicControlRenderContext[][] = [];\n\n  constructor(tRef: TemplateRef<NgForOfContext<DynamicControlRenderContext>>,\n              private differs: IterableDiffers,\n              vcRef: ViewContainerRef,\n              @Optional() dynForm: DynamicFormComponent<any>) {\n    super(vcRef, tRef, differs);\n\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (this.ready !== !!(this.tdmForm && this.fArray && this.fGroup && this.item && this.item.isArray) ) {\n      this.ready = !this.ready;\n\n      if (changes.fArray) {\n        const controls = this.fArray && this.fArray.controls;\n        this.trySetDiffer(controls);\n        changes.ngForOf = new SimpleChange(this.ngForOf, [], changes.fArray.isFirstChange());\n        this.ngForOf = changes.ngForOf.currentValue;\n        super.ngOnChanges(changes);\n      }\n    }\n  }\n\n  ngDoCheck(): void {\n    if (this.formArrayDiffer) {\n      const changes = this.formArrayDiffer.diff(this.fArray && this.fArray.controls);\n      if (changes) {\n        this.applyFormArrayChanges(changes);\n        super.ngDoCheck();\n      }\n    }\n  }\n\n  private applyFormArrayChanges(changes: IterableChanges<AbstractControl>) {\n    const renderers: DynamicControlRenderContext[] = <any> this.ngForOf;\n    changes.forEachOperation(\n      (item: IterableChangeRecord <any>, adjustedPreviousIndex: number, currentIndex: number) => {\n        if (item.previousIndex == null) {\n          const values = this.convert([this.fArray.controls[item.currentIndex]]);\n          const prevValues =  this.grouped[currentIndex - 1];\n          this.grouped[currentIndex] = values;\n          if (prevValues && prevValues.length > 0) {\n            currentIndex += prevValues.length;\n          }\n          renderers.splice(currentIndex, 0, ...values);\n        } else if (currentIndex == null) {\n          const values = this.grouped.splice(adjustedPreviousIndex, 1)[0];\n          renderers.splice(adjustedPreviousIndex, values.length);\n        } else {\n          const values = this.grouped.splice(adjustedPreviousIndex, 1)[0];\n          renderers.splice(adjustedPreviousIndex, values.length);\n\n          this.grouped[currentIndex] = values;\n          renderers.splice(currentIndex, 0, ...values);\n        }\n      });\n    changes.forEachIdentityChange((record: any) => {\n      const values = this.grouped.splice(record.currentIndex, 1)[0];\n      const newValues = this.convert([this.fArray.controls[record.currentIndex]]);\n      renderers.splice(record.currentIndex, values.length, ...newValues);\n    });\n  }\n\n  private convert(controls: AbstractControl[]): DynamicControlRenderContext[] {\n    const result: DynamicControlRenderContext[] = [];\n    for (let childControl of controls) {\n      for (let childItem of this.item.children ) {\n        const c = childItem.resolveFormArrayChild(childControl);\n        const $implicit: DynamicControlRenderContext  = <any> {\n          item: childItem,\n          fGroup: this.fGroup,\n          tdmForm: this.tdmForm,\n          [c instanceof FormArray ? 'fArray' : 'fControl']: c\n        };\n        result.push($implicit);\n      }\n    }\n    return result;\n  }\n\n  private trySetDiffer(value: AbstractControl[]): void {\n    if (!this.formArrayDiffer && value) {\n      try {\n        this.formArrayDiffer = this.differs.find(value).create();\n      } catch (e) {\n        throw new Error(`Cannot find a differ supporting object '${value}' of type '${getTypeNameForDebugging(value)}'.\\\n         NgFor only supports binding to Iterables such as Arrays.`);\n      }\n    }\n  }\n}\n\nexport function getTypeNameForDebugging(type: any): string {\n  return type['name'] || typeof type;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/@tdm/ngx-dynamic-forms/src/dynamic-forms/dynamic-form-array.directive.ts","import { ANALYZE_FOR_ENTRY_COMPONENTS, NgModule, ModuleWithProviders } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ReactiveFormsModule } from '@angular/forms';\n\nimport { Constructor } from '@tdm/core/tdm';\nimport { TDMModelFormService, TDMModelFormDirective } from './tdm-model-form/index';\nimport {\n  DynamicFormOverrideDirective,\n  DynamicFormControlDirective,\n  DynamicControlOutletDirective,\n  DynamicFormArrayComponent,\n  DynamicFormArrayDirective,\n  ForFormArrayDirective,\n  DynamicFormComponent\n} from './dynamic-forms/index';\n\nimport { FORM_CONTROL_COMPONENT, DefaultRenderer } from './default-renderer';\n@NgModule({\n  declarations: [\n    TDMModelFormDirective,\n    DynamicFormOverrideDirective,\n    DynamicFormControlDirective,\n    DynamicControlOutletDirective,\n    DynamicFormArrayComponent,\n    DynamicFormArrayDirective,\n    ForFormArrayDirective,\n    DynamicFormComponent\n  ],\n  imports: [CommonModule, ReactiveFormsModule],\n  exports: [\n    TDMModelFormDirective,\n    DynamicFormOverrideDirective,\n    DynamicFormControlDirective,\n    DynamicControlOutletDirective,\n    DynamicFormArrayComponent,\n    DynamicFormArrayDirective,\n    ForFormArrayDirective,\n    DynamicFormComponent\n  ]\n})\nexport class DynamicFormsModule {\n  /**\n   * Registers the module with and required services and with the default form control renderer.\n   */\n  static forRoot(formComponent: DefaultRenderer): ModuleWithProviders {\n    return {\n      ngModule: DynamicFormsModule,\n      providers: [\n        TDMModelFormService,\n        {\n          provide: ANALYZE_FOR_ENTRY_COMPONENTS,\n          multi: true,\n          useValue: [{component: formComponent}]\n        },\n        {provide: FORM_CONTROL_COMPONENT, useValue: formComponent}\n      ]\n    };\n  }\n\n  /**\n   * Registers the module with the default form control renderer.\n   * Use this when adding to child modules which requires a different renderer.\n   */\n  static forChild(formComponent: DefaultRenderer): ModuleWithProviders {\n    return {\n      ngModule: DynamicFormsModule,\n      providers: [\n        {\n          provide: ANALYZE_FOR_ENTRY_COMPONENTS,\n          multi: true,\n          useValue: [{component: formComponent}]\n        },\n        {provide: FORM_CONTROL_COMPONENT, useValue: formComponent}\n      ]\n    };\n  }\n}\n\n/**\n * @deprecated Object renamed, use DynamicFormsModule instead\n */\nexport const TDMFormsModule = DynamicFormsModule;\n/**\n * @deprecated Object renamed, use DynamicFormsModule instead\n */\nexport type TDMFormsModule = Constructor<DynamicFormsModule> & DynamicFormsModule;\n\n\n\n// WEBPACK FOOTER //\n// ./src/@tdm/ngx-dynamic-forms/src/module.ts","<ng-content></ng-content>\n\n\n// WEBPACK FOOTER //\n// ./node_modules/@angular/material/icon/typings/index.d.ts.MatIcon.html","const IN_FLIGHT_PROP_CHANGE = new WeakMap<any, any>();\n\nexport interface PropChange<Z = any> {\n  curr: Z;\n  prev: Z;\n  isFirst: boolean;\n}\n\nexport type PropChanges<T> = {\n  [P in keyof T]: PropChange<T[P]>;\n};\n\nexport interface PropNotifyHandler<T = any> {\n  onPropChange(T, changes: PropChanges<T> ): void;\n}\n\nexport interface PropNotifier<T = any> {\n  onPropChange?: PropNotifyHandler<T>;\n}\n\nexport function PropNotify(): PropertyDecorator {\n  return (target: Object, propertyKey: string) => {\n    const __propertyKey = `__${propertyKey}`; // tslint:disable-line\n    Object.defineProperty(target, propertyKey, {\n      get(this: PropNotifier) {\n        return this[__propertyKey];\n      },\n      set(this: PropNotifier, curr: any) {\n        if (this[__propertyKey] !== curr) {\n          const isFirst = !(__propertyKey in this);\n          const prev = this[__propertyKey];\n          this[__propertyKey] = curr;\n          if (this.onPropChange) {\n            let changes = IN_FLIGHT_PROP_CHANGE.get(this);\n            if (!changes) {\n              changes = {};\n              IN_FLIGHT_PROP_CHANGE.set(this, changes);\n              Promise.resolve(null).then( () => {\n                IN_FLIGHT_PROP_CHANGE.delete(this);\n                this.onPropChange.onPropChange(this, changes);\n              });\n            }\n            changes[propertyKey] = {\n              curr,\n              prev,\n              isFirst\n            };\n\n            //  SYMBOL VERSION\n            //\n            // const IN_PROP_CHANGE = Symbol('IN_PROP_CHANGE');\n            //\n            // if (!this[IN_PROP_CHANGE]) {\n            //   this[IN_PROP_CHANGE] = {};\n            //   Promise.resolve(null).then( () => {\n            //     const changes = this[IN_PROP_CHANGE];\n            //     this[IN_PROP_CHANGE] = false;\n            //     this.onPropChange.onPropChange(this, changes);\n            //   });\n            // }\n            // this[IN_PROP_CHANGE][propertyKey] = {\n            //   curr,\n            //   prev,\n            //   isFirst\n            // };\n          }\n        }\n      }\n    });\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/@tdm/ngx-dynamic-forms/src/prop-notify.ts","<ng-content></ng-content>\n\n\n// WEBPACK FOOTER //\n// ./node_modules/@angular/material/list/typings/index.d.ts.MatNavList.html","<ng-content></ng-content>\n\n\n// WEBPACK FOOTER //\n// ./node_modules/@angular/material/list/typings/index.d.ts.MatList.html","<div class=\"mat-list-item-content\"><div class=\"mat-list-item-ripple\" mat-ripple [matRippleTrigger]=\"_getHostElement()\" [matRippleDisabled]=\"_isRippleDisabled()\"></div><ng-content select=\"[mat-list-avatar], [mat-list-icon], [matListAvatar], [matListIcon]\"></ng-content><div class=\"mat-list-text\"><ng-content select=\"[mat-line], [matLine]\"></ng-content></div><ng-content></ng-content></div>\n\n\n// WEBPACK FOOTER //\n// ./node_modules/@angular/material/list/typings/index.d.ts.MatListItem.html","<div class=\"mat-list-item-content\" [class.mat-list-item-content-reverse]=\"checkboxPosition == 'after'\" [class.mat-list-item-disabled]=\"disabled\"><div mat-ripple class=\"mat-list-item-ripple\" [matRippleTrigger]=\"_getHostElement()\" [matRippleDisabled]=\"_isRippleDisabled()\"></div><mat-pseudo-checkbox [state]=\"selected ? 'checked' : 'unchecked'\" [disabled]=\"disabled\"></mat-pseudo-checkbox><div class=\"mat-list-text\" #text><ng-content></ng-content></div></div>\n\n\n// WEBPACK FOOTER //\n// ./node_modules/@angular/material/list/typings/index.d.ts.MatListOption.html","<ng-content></ng-content>\n\n\n// WEBPACK FOOTER //\n// ./node_modules/@angular/material/list/typings/index.d.ts.MatSelectionList.html","import { AbstractControl, FormArray, FormGroup, FormControl } from '@angular/forms';\nimport { isJsObject, isPrimitive, PlainObjectMapper } from '@tdm/core/tdm';\n\n/**\n * Performs a FormArray deep clone.\n * Does not clone state.\n * Does not clone values but can assign if a value is supplied.\n * Does clone sync and async validators.\n */\nexport function clone(control: FormArray, value?: any[]): FormArray;\n/**\n * Performs a FormGroup deep clone.\n * Does not clone state.\n * Does not clone values but can assign if a value is supplied.\n * Does clone sync and async validators.\n */\nexport function clone(control: FormGroup, value?: any): FormGroup;\nexport function clone(control: FormArray | FormGroup | FormControl,\n                      value?: any | any[]): FormArray | FormGroup | FormControl {\n  let result: FormArray | FormGroup | FormControl;\n  if (control instanceof FormControl) {\n    result = new FormControl(value);\n  } else if (control instanceof FormArray) {\n    value = Array.isArray(value) ? value : [];\n    result = new FormArray(control.controls.map( (c, i) => clone(control, value[i])));\n  } else if (control instanceof FormGroup) {\n    value = isJsObject(value) ? value : {};\n    const keys = Object.keys(control.controls);\n    result = new FormGroup(keys.reduce( (controls, key) => {\n      controls[key] = clone(<any> control.controls[key], value[key]);\n      return controls;\n    }, {} as { [key: string]: AbstractControl }));\n  }\n  if (control.validator) {\n    result.setValidators(control.validator);\n  }\n  if (control.asyncValidator) {\n    result.setAsyncValidators(control.asyncValidator);\n  }\n  return result;\n}\n\n/**\n * Converts a plain object (POJO) to a FormGroup or an array of plain object to FormArray\n */\nexport function objectToForm(obj: any, plainMapper?: PlainObjectMapper): FormGroup | FormArray {\n  if (!plainMapper) {\n    plainMapper = new PlainObjectMapper();\n  }\n\n  let data: FormGroup | FormArray;\n  if (Array.isArray(obj)) {\n    data = new FormArray(obj.map(o => objectToForm(o)));\n  } else {\n    data = new FormGroup({});\n    const serialized = plainMapper.serialize(obj);\n\n    Object.keys(serialized)\n      .forEach(key => {\n        const value = serialized[key];\n        let ctrl = isPrimitive(value)\n          ? new FormControl(value)\n          : this.serializePlain(value)\n        ;\n        (data as FormGroup).addControl(key, ctrl);\n      });\n  }\n  return data;\n}\n\n// Taken from https://github.com/angular/material2/blob/master/src/cdk/coercion/boolean-property.ts\n/** Coerces a data-bound value (typically a string) to a boolean. */\nexport function coerceBooleanProperty(value: any): boolean {\n  return value != null && `${value}` !== 'false';\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/@tdm/ngx-dynamic-forms/src/utils.ts","import { Type } from '@angular/core';\nimport { AbstractControl, FormGroup, FormArray, FormControl } from '@angular/forms';\n\nimport { stringify, isNumber } from '@tdm/core/tdm';\nimport { FormModelMetadata, FormPropMetadata, NgFormsBoundMapper, NgFormsSerializeMapper } from '../core/index';\nimport { createControl } from '../create-control';\nimport { TDMModelFormService } from './tdm-model-form.service';\nimport { RenderInstruction } from './render-instruction';\nimport { PropNotifyHandler, PropChanges } from '../prop-notify';\n\nexport interface DynamicControlRenderContext {\n  item: RenderInstruction;\n  tdmForm: TDMModelForm<any>;\n  fArray?: FormArray | undefined;\n  fControl?: FormControl | undefined;\n  fGroup?: FormGroup | undefined;\n\n  tdmOnControlContextInit?(): void ;\n}\n\nfunction getFormIsNotArrayErrorMessage(value: AbstractControl | undefined): string {\n  const got = value ? 'undefined' : stringify(value.constructor);\n  return `A control can only be added to a form array instance, got ${ got }`;\n}\n\n/**\n * Takes a path and removes all array references.\n * returns a tuple [immidiate prop name, rest of the path]\n */\nfunction normalizeFormPath<T = any>(path: Array<string | number> | string): [keyof T, string] {\n  const isNumberRe = /^\\d+$/;\n  const pathArr = Array.isArray(path)\n    ? path.filter( n => !isNumber(n) )\n    : path.split('.').filter( v => !isNumberRe.test(v) )\n  ;\n  return [<any> pathArr.shift(), pathArr.join('.')];\n}\n\n/**\n * A container that binds a model instance and and a `FormGroup` instance.\n *\n * This class is a facade, it simplifies the logic and low level operations required to bind a model\n * and a form:\n *   - mapping between model and form (serialization and deserialization)\n *   - exposing rendering instructions for a model (the instructions are used to render form elements)\n */\nexport class TDMModelForm<T = any> implements PropNotifyHandler {\n\n  form: FormGroup;\n\n  /**\n   * When set, will proxy all incoming property changes from RenderInstruction to this handler.\n   */\n  set propNotifyHandler(value: PropNotifyHandler) {\n    this.onPropChange = value.onPropChange.bind(value);\n  }\n\n  get model(): T {\n    return this._model;\n  }\n\n  get type(): Type<T> {\n    return this._type;\n  }\n\n  get ready(): boolean {\n    return this._ready;\n  }\n\n  /**\n   * The render instructions for the TDMModel type of this instance.\n   * @returns\n   */\n  get renderData(): RenderInstruction[] {\n    if (!this._renderData) {\n      const clone = this.modelFormService.createRICloneFactory<any>(this);\n      this._renderData = this.modelFormService.getInstructions(this.type).map(clone);\n    }\n    return this._renderData;\n  }\n\n  private _renderData: RenderInstruction[];\n  private mapper: NgFormsBoundMapper<any>;\n  private formMeta: FormModelMetadata;\n  private _type: Type<T>;\n  private _model: T;\n  private _ready: boolean;\n\n  constructor(protected modelFormService: TDMModelFormService) { }\n\n  onPropChange(ri: RenderInstruction, changes: PropChanges<RenderInstruction>): void { } // tslint:disable-line\n\n  /**\n   * Retrieves a child control given the control's name or path.\n   *\n   * > This is method is just sugar for `tDMModelFormInstance.form.get(path)`\n   *\n   * @param path The path (runtime), relative to the root form. Accepts the same types as `AbstractControl.get`.\n   * See {@link https://angular.io/api/forms/AbstractControl#get}\n   */\n  get(path: Array<string | number> | string): AbstractControl | null {\n    return this.form.get(path);\n  }\n\n  /**\n   * Retrieves the value of a child control given the control's name or path.\n   *\n   * > This is method is just sugar for `tDMModelFormInstance.form.get(path).value`\n   *\n   * @param path The path, relative to the root form. Accepts the same types as `AbstractControl.get`.\n   * See {@link https://angular.io/api/forms/AbstractControl#get}\n   */\n  getValue(path: Array<string | number> | string): any | null {\n    const c = this.form.get(path);\n    return c ? c.value : null;\n  }\n\n  /**\n   * Retrieves a value from the model given a name or path.\n   * Paths can be passed in as an array or a string delimited by a dot.\n   *\n   * This method does the same thing `getValue` with one difference, the context the `path` is applied on.\n   * This methods returns the resolved value using the model instance as the context.\n   * `getValue` returns the resolved value using the root form control value as the context.\n   */\n  getValueModel(path: Array<string | number> | string): any | null;\n  getValueModel(item: RenderInstruction, control: AbstractControl): any | null;\n  getValueModel(path: Array<string | number> | string | RenderInstruction, control?: AbstractControl): any | null {\n    const pathArr = path instanceof RenderInstruction\n      ? path.getRuntimePath(control).split('.')\n      : Array.isArray(path) ? path : path.split('.')\n    ;\n\n    let m = this.model;\n    for (let p of pathArr) {\n      m = m[p];\n      if (!m) {\n        break;\n      }\n    }\n    return m;\n  }\n\n  /**\n   * Set's the provided `value` in the provided `path`. The path is applied from the root form.\n   *\n   * > This is method is just sugar for `tDMModelFormInstance.form.get(path).setValue(value)`\n   *\n   * @param path The path, relative to the root form. Accepts the same types as `AbstractControl.get`.\n   * See {@link https://angular.io/api/forms/AbstractControl#get}\n   * @param value The value to apply on the control retrieved from path\n   * @param options\n   */\n  setValue(path: Array<string | number> | string, value: any, options?: any): void {\n    this.form.get(path).setValue(value, options);\n  }\n\n  hasError(errorCode: string, path: keyof T): boolean {\n    return this.form.hasError(errorCode, path as any);\n  }\n\n  /**\n   * Sync's the model with the form.\n   * When `patch` is true will perform a silent update without throwing when structure does not match.\n   * Running this method is a identical to calling patchValue / setValue on the form with the model instance.\n   */\n  sync(patch: boolean = true,\n       options?: { onlySelf?: boolean; emitEvent?: boolean; }): void {\n    if (patch) {\n      this.form.patchValue(this.model, options);\n    } else {\n      this.form.setValue(this.model, options);\n    }\n  }\n\n  /**\n   * Reset's the form and sync's it with the model.\n   *\n   * This method has no effect when a hot bind is set between the model and the form, it will reset the form\n   * and sync it with the model in it's current state.\n   */\n  reset(options?: { onlySelf?: boolean; emitEvent?: boolean; }): void {\n    for (let r of this.renderData) {\n      if (r.isArray) {\n        const formArray: FormArray = <any> this.get(r.fullName);\n        if (this.resetFormArray(formArray, this.getValueModel(r, formArray), r.fullName)) {\n          r.markAsChanged();\n        }\n      }\n      // TODO: move resetControl to here, with optional `path` param\n      // TODO: handle standalone childForm in here\n    }\n    this.form.reset(this._model, options);\n  }\n\n  /**\n   * Like reset but for a specific control.\n   */\n  resetControl(path: Array<string | number> | string): void {\n    const pathArr = normalizeFormPath<T>(path);\n    const value = this.getValueModel(path);\n    const formProp = this.getFormProp(pathArr);\n    const control = this.get(path);\n    if (control instanceof FormArray) {\n      this.resetFormArray(control, value, pathArr.join('.'));\n    } else if (formProp.childForm && ! (control.parent instanceof FormArray) ) {\n      // standalone child form will recreate itself, this will set the control to FormControl if it's null\n      control.parent.setControl(<any> formProp.name, this.createControl(pathArr.join('.'), value, false));\n    } else {\n      control.reset(value);\n    }\n  }\n\n  createChildForm<Z = any>(path: Array<string | number> | string, model?: Z, formGroup?: FormGroup): TDMModelForm<Z> {\n    const pathArr = normalizeFormPath<T>(path);\n    const formProp = this.getFormProp(pathArr);\n    if (!formProp.childForm) {\n      throw new Error(\n        `Form property metadata ${pathArr.join('.')} for type ${stringify(this.type)} is not a \"childForm\"`);\n    } else {\n      if (!model) {\n        model = new formProp.rtType.ref();\n      }\n      return this.modelFormService.create(model, formProp.rtType.ref, formGroup);\n    }\n  }\n\n  /**\n   * Create a new form control based on the type at `path`.\n   * See `createControl` for details.\n   *\n   * @param path The path (static), relative to the root form.\n   * Accepts the same types as `AbstractControl.get`. See {@link https://angular.io/api/forms/AbstractControl#get}\n   *\n   * @param value An existing value that represents the value of the new form control, if not set the form control will\n   * have no value  (i.e. represents a new instance of the model).\n   *\n   * @param tryCreateNew When true and value is undefined or null, will try to create new value with the new keyword\n   * using the type at the path.\n   */\n  createControl(path: string[] | string, value?: any, tryCreateNew?: boolean): FormGroup | FormControl {\n    return createControl(this.type, normalizeFormPath<T>(path), value, tryCreateNew);\n  }\n\n  /**\n   * Adds a new form control to a FormArray instance at the provided path.\n   * See `createControl` for details.\n   *\n   * This is a utility method for easy add/remove operations on UI form's with a FormArray instance.\n   *\n   * @param path The path (static), relative to the root form.\n   * Accepts the same types as `AbstractControl.get`. See {@link https://angular.io/api/forms/AbstractControl#get}\n   *\n   * @param value An existing value that represents the value of the new form control, if not set the form control will\n   * have no value (i.e. represents a new instance of the model).\n   *\n   * @param tryCreateNew When true and value is undefined or null, will try to create new value with the new keyword\n   * using the type at the path.\n   */\n  appendControl(path: Array<string | number> | string, value?: any, tryCreateNew?: boolean): FormGroup | FormControl {\n    const formArray = this.form.get(path);\n    if (formArray instanceof FormArray) {\n      // we got the instance, now move to type metadata world where all array index references, if exist, must go out.\n      const pathArr = normalizeFormPath(path);\n      const ctrl = createControl(this.type, <any> pathArr, value, tryCreateNew);\n      formArray.push(ctrl);\n      return ctrl;\n    } else {\n      throw new Error(getFormIsNotArrayErrorMessage(formArray));\n    }\n  }\n\n  /**\n   * Removes a form control in the provided index from a FormArray instance at the provided path.\n   *\n   * This is a utility method for easy add/remove operations on UI form's with a FormArray instance.\n   *\n   * @param path The path, relative to the root form. Accepts the same types as `AbstractControl.get`.\n   * See {@link https://angular.io/api/forms/AbstractControl#get}\n   * @param query The index at the form array to remove at or a form control instance to remove from the form array.\n   * @returns The removed control or undefined if nothing was removed.\n   */\n  removeControl(path: Array<string | number> | string, query: number | AbstractControl): AbstractControl | undefined {\n    const formArray = this.form.get(path);\n    if (formArray instanceof FormArray) {\n      const idx = isNumber(query) ? query : formArray.controls.indexOf(query);\n      const ctrl = formArray.controls[idx];\n      if (ctrl) {\n        formArray.removeAt(idx);\n      }\n      return ctrl;\n    } else {\n      throw new Error(getFormIsNotArrayErrorMessage(formArray));\n    }\n  }\n\n  /**\n   * Set the context for this the form.\n   * @param instance The TDModel instance\n   * @param type The TDModel class, if not set instance.constructor is the default.\n   * @param formGroup An optional [[FormGroup]] instance, if set it will be used instead of serializing a new one\n   */\n  setContext(instance: T): void;\n  setContext(instance: T, type: Type<T>): void;\n  setContext(instance: T, formGroup: FormGroup): void;\n  setContext(instance: T, type: Type<T>, formGroup: FormGroup): void;\n  setContext(instance: T, type?: Type<T> | FormGroup, formGroup?: FormGroup): void {\n    if (type instanceof FormGroup) {\n      formGroup = type;\n      type = undefined;\n    }\n\n    if (!type) {\n      type = <any> instance.constructor;\n    }\n\n    if (this._model === instance && this._type === type) {\n      return;\n    }\n\n    if (this._type !== type) {\n      this._type = type as Type<T>;\n      this.formMeta = this.modelFormService.getMeta(this._type);\n    }\n\n    if (this._model !== instance) {\n      this._model = instance;\n    }\n\n    this.update(formGroup);\n  }\n\n  /**\n   * A helper function for an *ngFor \"trackBy\" handler.\n   * > It is not recommended to change the trackBy logic when using `dynamic-form` component, the change detection logic\n   * is based on it.\n   * @param idx\n   * @param item\n   * @returns\n   */\n  trackBy(idx: number, item: RenderInstruction): any {\n    return item.hash;\n  }\n\n  /**\n   * Commit the form data into the model instance. (deserialize)\n   *\n   * Note that the response might be true even if the form was not dirty.\n   * The response is always true when onlyIfDirty === false.\n   * If onlyIfDirty is true and the form is NOT dirty, only then the response is false.\n   *\n   * @param onlyIfDirty if true will commit only if the form is dirty\n   * @returns Did it commit (deserialize)\n   */\n  commitToModel(onlyIfDirty?: boolean): boolean {\n    if (onlyIfDirty === true && !this.form.dirty) {\n      return false;\n    }\n    this.mapper.deserialize();\n    return true;\n  }\n\n  /**\n   * @internal\n   */\n  bindRenderingData(controlRenderer: DynamicControlRenderContext,\n                    renderData: RenderInstruction): void {\n    controlRenderer.tdmForm = this;\n    controlRenderer.fGroup = renderData.flattened\n      ? this.form.get(renderData.flattened) as FormGroup\n      : this.form\n    ;\n    if (renderData.isArray) {\n      controlRenderer.fArray = <any> controlRenderer.fGroup.get(renderData.name);\n    } else {\n      controlRenderer.fControl = <any> controlRenderer.fGroup.get(renderData.name);\n    }\n    controlRenderer.item = renderData;\n  }\n\n  protected getFormProp(path: [keyof T, string]): FormPropMetadata {\n    const formProp = NgFormsSerializeMapper.getFormProp(this.type, path);\n    if (!formProp) {\n      throw new Error(\n        `Could not find form property metadata for type ${stringify(this.type)} using path ${path.join('.')}`);\n    }\n    return formProp;\n  }\n\n  protected update(formGroup?: FormGroup): void {\n    if (this._type && this._model) {\n      this.mapper = new NgFormsBoundMapper(this._type, this.model, formGroup);\n      this.form = formGroup || this.mapper.serialize();\n      this._ready = true;\n    } else {\n      this.mapper = this.form = undefined;\n      this._ready = false;\n    }\n  }\n\n  /**\n   * FormArray's require specific reset because `@angular/forms` logic does not match the array but the content only.\n   */\n  private resetFormArray(formArray: FormArray, value: any, staticPath: string): boolean {\n    if (formArray.dirty || formArray.length !== (value ? value.length : 0)) {\n      formArray.controls.splice(0, formArray.controls.length);\n      if (value) {\n        for (let m of value) {\n          formArray.push(this.createControl(staticPath, m));\n        }\n      }\n      return true;\n    }\n    return false;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/@tdm/ngx-dynamic-forms/src/tdm-model-form/tdm-model-form.ts","import { Type, Input, Directive } from '@angular/core';\n\nimport { TDMModelFormService } from './tdm-model-form.service';\nimport { TDMModelForm } from './tdm-model-form';\n\n/**\n * A helper Directive to expose TDMModelForm within a template.\n *\n * This is an alternate method for create forms on a template. Instead of using an injected\n * TDMModelFormService instance to create instances of TDMModelForm you can use this directive.\n *\n * @example\n * ```ts\n * <div #tdmForm=\"tdmModelForm\" [tdmModelForm]=\"user\">\n *   <form [formGroup]=\"tdmForm.form\" novalidate>\n *     <div *ngFor=\"let item of tdmForm.renderData; trackBy: tdmForm.trackBy\" class=\"row\">\n *       <div [ngSwitch]=\"item.vType\" class=\"row\">\n *         <input *ngSwitchCase=\"'boolean'\" type='checkbox' [formControlName]=\"item.name\">{{ item.label }} />\n *         <input *ngSwitchCase=\"'text'\" type='text' [formControlName]=\"item.name\">{{ item.label }} />\n *         <input *ngSwitchCase=\"'number'\" type='number' [formControlName]=\"item.name\">{{ item.label }} />\n *      </div>\n *   </form>\n * </div>\n * ```\n */\n@Directive({\n  selector: '[tdmModelForm]',\n  exportAs: 'tdmModelForm'\n})\nexport class TDMModelFormDirective<T> extends TDMModelForm<T> {\n\n  @Input() set tdmModelForm(value: T | [T, Type<T>]) {\n    const [instance, type] = Array.isArray(value) ? value : [value, <any> value.constructor];\n    this.setContext(instance, type);\n  }\n\n  constructor(modelFormService: TDMModelFormService) {\n    super(modelFormService);\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/@tdm/ngx-dynamic-forms/src/tdm-model-form/tdm-model-form.directive.ts","<mat-accordion class=\"package-feature-list\">\n  <mat-expansion-panel *ngFor=\"let f of features\">\n    <mat-expansion-panel-header>\n      <mat-panel-title><mat-icon>check</mat-icon>{{f.title}}</mat-panel-title>\n    </mat-expansion-panel-header>\n    <tdm-markdown-view *ngIf=\"f.md\" [markdown]=\"f.description\"></tdm-markdown-view>\n    <ng-container *ngIf=\"!f.md\">{{f.description}}</ng-container>\n  </mat-expansion-panel>\n</mat-accordion>\n\n\n\n// WEBPACK FOOTER //\n// ./src/demo/modules/@shared/components/feature-list/feature-list.component.html","import { Observable } from 'rxjs/Observable';\nimport { toPromise } from 'rxjs/operator/toPromise';\n\nimport { RenderInstruction } from '../tdm-model-form/render-instruction';\n\nconst asyncUsed = (done: Promise<void> | Observable<void>) => {\n  throw new Error('async() was already called once.');\n};\n\nexport class BeforeRenderEventHandler {\n  /**\n   * An object whose values are instances of [[RenderInstruction]] and keys are the full static paths of the\n   * [[RenderInstruction]] instance they refer to.\n   */\n  public instructions: { [path: string]: RenderInstruction };\n\n  constructor(instructions: { [path: string]: RenderInstruction },\n              private notify: (done: Promise<void>) => void) {\n    this.instructions = instructions;\n  }\n\n  /**\n   * Mark this render operation as asynchronous, providing a notifier to signal when the rendering can\n   * proceed.\n   *\n   * For example, when a render instruction of type select requires the options of the select to be\n   * fetched from a remote server.\n   *\n   * @param done\n   */\n  async(done: Promise<void> | Observable<void>): void {\n    if (typeof done['then'] === 'function') {\n      this.notify(<any> done);\n    } else if (typeof done['subscribe'] === 'function') {\n      this.notify( toPromise.call(<Observable<void>>done) );\n    } else {\n      throw new Error('Invalid input');\n    }\n    Object.defineProperty(this, 'async', { value: asyncUsed });\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/@tdm/ngx-dynamic-forms/src/dynamic-forms/before-render-event-handler.ts","import { Validators, ValidatorFn, AsyncValidatorFn } from '@angular/forms';\n\nexport interface BuiltInValidations {\n  required?: boolean;\n}\n\nfunction normValidators(v: any): any[] {\n  return !v ? [] : Array.isArray(v) ? v.slice() : [ v ];\n}\n\n// tslint:disable-next-line\nexport function getValidators(obj: {validators: ValidatorFn | ValidatorFn[] | null, asyncValidators: AsyncValidatorFn | AsyncValidatorFn[] | null },\n                              builtIn?: BuiltInValidations): [ValidatorFn | null, AsyncValidatorFn | null] {\n  const sync: ValidatorFn[] = normValidators(obj.validators);\n  const async = normValidators(obj.asyncValidators);\n\n  if (builtIn) {\n    if (builtIn.required === true) {\n      sync.push(Validators.required);\n    }\n  }\n\n  return [\n    sync.length > 0 ? Validators.compose(sync) : null,\n    async.length > 0 ? Validators.composeAsync(async) : null\n  ];\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/@tdm/ngx-dynamic-forms/src/validation.ts","import { AbstractControl, FormArray, ValidatorFn, AsyncValidatorFn } from '@angular/forms';\nimport { FormPropMetadata } from '../core/metadata/form-prop';\nimport { FormElementType, RenderDef } from '../interfaces';\nimport { getValidators } from '../validation';\nimport { PropNotify } from '../prop-notify';\n\n/**\n * Render definition with the name of the control.\n *\n * The internal logic for handling render instruction is array based (due to ordering) but the\n * user-defined `RenderDef` is object based (hash) and does not require name (name inferred from key).\n *\n * When moving user-defined render definition into an array we need to preserve the name, this interface\n * defines the contract.\n *\n * @internal\n */\nexport class RenderInstruction<T extends keyof FormElementType = keyof FormElementType> implements RenderDef<T> {\n  /**\n   * A object used to mark changes in the instruction for ngFor iterations.\n   *\n   * @internal\n   */\n  hash: any;\n\n  /**\n   * Marks the hidden state of the control.\n   */\n  hidden?: boolean;\n\n  @PropNotify() required: boolean;\n\n  /**\n   * The order of the control in the form\n   */\n  @PropNotify() ordinal?: number;\n\n  /**\n   * The label to display (e.g. placeholder, description etc...)\n   */\n  @PropNotify() label?: string;\n\n  /**\n   * The visual type of the element.\n   *\n   * The rendering component will use this type to render the component.\n   *\n   * If no type is set the library will try to assign a primitive (string, number or boolean) based\n   * on the type information. If no primitive was matched an error is thrown.\n   */\n  @PropNotify() vType: T;\n\n  @PropNotify() validators: ValidatorFn | ValidatorFn[] | null;\n\n  @PropNotify() asyncValidators: AsyncValidatorFn | AsyncValidatorFn[] | null;\n\n  /**\n   * Extra data to be used by the renderer.\n   *\n   * Examples:\n   *   - regex, min/max, etc.. for validation\n   *   - options (options) array for a select type\n   */\n  data: FormElementType[T];\n\n  /**\n   * When set indicated this is form control flattened from a nested object.\n   * The string represents the path **from the root control** (NgForm) to the parent of this flattened control.\n   *\n   * The path support the same values accepted by the `get` method in `AbstractControl`, i.e.\n   * you can use dot notation / Array<string | number> to describe deep paths.\n   * See https://angular.io/api/forms/AbstractControl#get\n   */\n  flattened?: Array<string | number>;\n\n  /**\n   * When true the type of the value is a primitive, i.e. the form control is FormControl.\n   * else, the type of the value is complex, i.e. FormGroup.\n   *\n   * If the current instruction is an array (has children) this represents the type of the children.\n   */\n  isPrimitive: boolean;\n\n  /**\n   * A virtual instruction is an instruction that is not part of the rendering flow but represents a physical control.\n   * A virtual instruction is used for form graph control hierarchy, it is the parent of all properties of a flatten\n   * expression.\n   * When flattening, the UI is required to show a nested object or parts of it at the same level of the root, this has\n   * not depth limitation as you can nest flatten declaration. The form is bound to the model and it can not change it's\n   * structure so the library manages the transformation between UI and Data model.\n   *\n   * This is why a virtual field will not be part of the rendering array but will be the parent of a flattened property.\n   */\n  isVirtual: boolean;\n\n  get isChildForm(): boolean {\n    return this.formProp.childForm;\n  }\n\n  /**\n   * Valid on when isVirtual is true.\n   * Contains the child properties of a complex object, this will usually match the corresponding FormGroup instance\n   * `controls` property where this array is reduces to a key->value object where the keys are the name property of each\n   * instance in the array.\n   */\n  virtualChildren?: RenderInstruction[];\n\n  /**\n   * When true indicates that the instruction is for a FormArray.\n   */\n  isArray: boolean;\n\n  /**\n   * When set indicates that the instruction is for a FormArray.\n   */\n  children?: RenderInstruction[];\n\n  /**\n   * The path to the current item relative to the child of the first array up the ancestor tree.\n   *\n   * The path is set only for flattening expression of an array, in that scenario the data model structure for the UI,\n   * which is the form, is different from the render instructions data structure.\n   *\n   * The `FormArray` instance contains `FromGroup` instances while the render instruction matching the `FormArray`\n   * instance contains the elements we need to render, i.e. the primitives flattened controls.\n   *\n   * We need to resolve the `FormControl` matching each child using the `FormGroup` item, this path enables that\n   * because it is relative to the first item in the array, which is our `FormGroup`\n   *\n   * Example:\n   * ```ts\n   * @Prop({\n   *   form: {\n   *     flatten: {\n   *       y: {\n   *         flatten: {\n   *           z: {\n   *             render: {\n   *               vType: 'number'\n   *             }\n   *           }\n   *         }\n   *       }\n   *     }\n   *   }\n   * })\n   * x: Array<{\n   *   y: {\n   *     z: number;\n   *   }\n   * }>;\n   * ```\n   *\n   * The property above describes an array of an object defined using a flattening expression.\n   * The object has an inner object `y` and `y` has a property `z`.\n   *\n   * The flattening expression extract's `z`.\n   *\n   * The renderer will get a `FormArray` instance with each child being a `FormGroup` with item `x`.\n   * the render instructions will represent and array with each child representing `z`.\n   *\n   * We need to resolve the control bound to the UI element, the control that matches `z` but we have `FormGroup` `x`\n   * which contains that control.\n   *\n   * This path will resolve that and it's value will be `y.z`. We have `x` so we get `y` then from `y` we get `z`.\n   *\n   * This will work with any level\n   *\n   * @internal\n   */\n  _arrayPath?: string;\n\n  /**\n   * The full name.\n   * The full name is usually identical to the name, except for instructions that are part of a `flattening` expression.\n   *\n   * When the instruction is part of a `flattening` expressions the full name is also refered to as the `static path`\n   * The static path is used for metadata lookup, where all arrays are meaningless and only their type is required.\n   *\n   * > It is recommended to use the full name at all times, except for visual display purpose.\n   */\n  get fullName(): string {\n    const fullName =  this.flattened\n      ? this.flattened.join('.') + '.' + this.name\n      : this.name\n    ;\n    Object.defineProperty(this, 'fullName', { value: fullName, writable: false });\n    return fullName;\n  }\n\n  constructor(public name: string,\n              private formProp: FormPropMetadata = FormPropMetadata.EMPTY,\n              public parent?: RenderInstruction) {\n    if (formProp.required) {\n      this.required = true;\n    }\n    if (formProp.validators) {\n      this.validators = formProp.validators;\n    }\n    if (formProp.asyncValidators) {\n      this.asyncValidators = formProp.asyncValidators;\n    }\n\n    Object.assign(this, formProp.render);\n    this.hash = this;\n  }\n\n  /**\n   * Call this function when changing properties in this [[RenderInstruction]] instance, before calling\n   * [[DynamicFormComponent.redraw]] or when you want a specific control to re-render.\n   *\n   * You can set a custom hash, you can use it to pass data between new renderer instances.\n   */\n  markAsChanged(hash?: { [key: string]: any }): void {\n    this.hash = hash === this.hash ? {} : hash || {};\n  }\n\n  /**\n   * A helper method that merge's (assign) the provided value into the existing `data` object.\n   * If a `data` object is undefined it will create one.\n   */\n  mergeData(value: any): void {\n    this.data = Object.assign(this.data || {}, value);\n  }\n\n  /**\n   * A helper method that return the value of the property `key` in `this.data`\n   */\n  getData(key: string): any | undefined {\n    return this.data && this.data[key];\n  }\n\n  /**\n   * Returns the run-time path for this rendering item, relative to the root control.\n   * The run-time path is the path for form lookup which can be used in [[AbstractControl.get]].\n   *\n   * Because an @angular form control does not know it's name but does know it's parent we can use the rendering\n   * instructions to get the name and move up to the parent up to root to get the full path.\n   * If we find a parent that is an array we lookup the index and use it instead of the name.\n   */\n  getRuntimePath(control: AbstractControl): string {\n    const { parent } = control;\n    if (!parent || parent === control.root) {\n      return this.name;\n    } else {\n      const name = parent instanceof FormArray ? `${this.name}.${parent.controls.indexOf(control)}` : this.name;\n      return this.parent\n        ? `${this.parent.getRuntimePath(parent)}.${name}`\n        : name\n      ;\n    }\n  }\n\n  /**\n   * Use this method to resolve the `FormControl` instance from children of `FormArray`.\n   *\n   * If you will not use this method to resolve the form control and use the child control directly it will create\n   * issues when using flattening expressions with arrays.\n   */\n  resolveFormArrayChild(control: AbstractControl): AbstractControl {\n    return this._arrayPath ? control.get(this._arrayPath) : control ;\n\n  }\n\n  getValidators() {\n    return getValidators(this, this);\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/@tdm/ngx-dynamic-forms/src/tdm-model-form/render-instruction.ts","import { DynamicControlRenderContext, TDMModelForm } from './tdm-model-form';\nimport { ChildFormEditRendererEvent } from './dynamic-forms';\n\nfunction cloneContext(baseCtx: DynamicControlRenderContext,\n                      mergeCtx?: Partial<DynamicControlRenderContext>): DynamicControlRenderContext {\n  return Object.assign({\n    item: baseCtx.item,\n    tdmForm: baseCtx.tdmForm,\n    fArray: baseCtx.fArray,\n    fControl: baseCtx.fControl,\n    fGroup: baseCtx.fGroup,\n  }, mergeCtx || {});\n}\n\nexport function createChildFormEvent(ctx: DynamicControlRenderContext,\n                                     mergeCtx?: Partial<DynamicControlRenderContext>): ChildFormEditRendererEvent {\n  ctx = cloneContext(ctx, mergeCtx);\n  let createdTDMModelForm: TDMModelForm<any>;\n  const rootTdmForm = ctx.tdmForm;\n\n  return {\n    type: 'childFormEdit',\n    isNew: ctx.fControl.value === null,\n    context: ctx,\n    createTDMModelForm(): TDMModelForm<any> {\n      if ( createdTDMModelForm ) {\n        throw new Error('');\n      }\n      return createdTDMModelForm = ctx.tdmForm\n        .createChildForm(ctx.item.fullName, ctx.fControl.value, <any> ctx.fControl);\n    },\n    reset(): void {\n      // new that is not an array is inline, this requires reset of that specific control because it\n      // needs to be set to FormControl(null), which is a null FormGroup of child form.\n      if ( this.isNew && !this.context.item.isArray ) {\n        rootTdmForm.resetControl(ctx.item.fullName);\n      } else if ( createdTDMModelForm ) {\n        // we don't publish up, because it will change the state (pristine, dirty, etc) of the parent which\n        // on arrays is not true\n        createdTDMModelForm.reset({ onlySelf:  this.isNew });\n      }\n    }\n  } as ChildFormEditRendererEvent;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/@tdm/ngx-dynamic-forms/src/create-child-form-event.ts","<header>\n  <h1>{{title}}</h1>\n  <h2>{{description}}</h2>\n  <button class=\"tutorial-btn\" [routerLink]=\"[buttonLink]\" mat-raised-button color=\"primary\">{{buttonText}}</button>\n  <div class=\"install-box mat-body-2\">\n    npm install --save {{installCmd}}\n  </div>\n</header>\n\n\n\n// WEBPACK FOOTER //\n// ./src/demo/modules/@shared/components/package-welcome/package-welcome.component.html","/** PURE_IMPORTS_START .._Observable PURE_IMPORTS_END */\nimport { Observable } from '../Observable';\n// HACK: this is here for backward compatability\n// TODO(benlesh): remove this in v6.\nexport var toPromise = Observable.prototype.toPromise;\n//# sourceMappingURL=toPromise.js.map \n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/rxjs/_esm5/operator/toPromise.js\n// module id = nZ6e\n// module chunks = 0","import { Type, InjectionToken } from '@angular/core';\nimport { FormElementType } from './interfaces';\nimport { DynamicControlRenderContext } from './tdm-model-form/tdm-model-form';\n\n/**\n * A renderer component.\n */\nexport type ControlRenderer = Type<DynamicControlRenderContext>;\n\n/**\n * A map of visual types and the default renderer component to use for the visual type.\n * To set a fallback/catch all component use '*' as the key.\n */\nexport type DefaultRendererMap = Partial<Record<keyof FormElementType | '*' | '[]', ControlRenderer>>;\n\n/**\n * Default renderer definition.\n * Can be a ControlRenderer or a DefaultRendererMap\n */\nexport type DefaultRenderer = ControlRenderer | DefaultRendererMap;\n\n/**\n * A Token for the component that renders form controls\n */\nexport const FORM_CONTROL_COMPONENT = new InjectionToken<DynamicControlRenderContext>('DynamicControlRenderContext');\n\n\n\n// WEBPACK FOOTER //\n// ./src/@tdm/ngx-dynamic-forms/src/default-renderer.ts","import { ValidatorFn, AsyncValidatorFn } from '@angular/forms';\nimport {\n  stringify,\n  MetaClass,\n  PropMetadata,\n  BaseMetadata,\n  DecoratorInfo,\n  TypeMetadataArgs,\n  Constructor,\n  TypeMetadata\n} from '@tdm/core/tdm';\nimport { RenderDef, FormElementType } from '../../interfaces';\n\nexport interface FormPropMetadataArgs<T extends keyof FormElementType = keyof FormElementType> {\n  /**\n   * Exclude this property from the form.\n   * By default every class property decorated with @Prop or @FormProp is included in the output of\n   * a serialization process. Setting Exclude will make sure it is not part of the form.\n   *\n   * > NOTE: Setting exclude via `@Exclude` or `@Prop` with `exclude` does not exclude the `@FormProp`.\n   */\n  exclude?: boolean;\n\n  /**\n   * Transform the value\n   * @param value\n   */\n  transform?: (value: any) => any;\n\n  /**\n   * Definition for element rendering.\n   * Set this if you want your models to automatically render into forms.\n   */\n  render?: RenderDef<T>;\n\n  /**\n   * Sugar for adding a required validator\n   */\n  required?: boolean;\n\n  /**\n   * Flattens the rendering of an object or an array of objects into the root so they are rendered in the root level\n   * with other properties on the instance.\n   *\n   * A flattening definitions is a key -> value map where key's are the properties of the type decorated and the values\n   * are [[FormPropMetadataArgs]] for each property, it's sort of manual form control definition for a type.\n   *\n   * A flatten definition is defined on [[[[FormPropMetadataArgs]]]] and creates internal [[FormPropMetadataArgs]]\n   * values so we can say that it is recursive, i.e. you can define a flatten definition with one or more of the\n   * children having flatten definitions of their own and the same for the children of the children...\n   *\n   * Notice that flattening apply only on the rendering, it does not change the structure of the model and the generated\n   * form structure is identical to the model structure.\n   *\n   * The library will manage the transformation to and from the UI.\n   *\n   * ## Arrays\n   * When a flatten definition decorates an Array of T the array should be ignored and the definition should reflect the\n   * type of T, the fact that the type is and Array of T should not make a difference and the library will take that\n   * into account.\n   *\n   * NOTE: When decorating an Array of T, make sure to include the type, either in `@Prop` metadata or in the\n   * `rtType` property in [[FormPropMetadataArgs]] or it will register as Array<Object>.\n   *\n   * > Must decorate an object or array of objects, primitives are not allowed.\n   * Instructions for flattening the object referenced on this property.\n   * The property must reference a JS object.\n   *\n   * flatten properties does not require a render instructions.\n   * When set, the property is treated as a plain object regardless of it's type so you can also send plain JS objects.\n   *\n   * NOTE: [[FormPropMetadataArgs]] definitions in a flatten instruction might not support all features.\n   *       If you want to maximize use make sure to manually define the run-time types.\n   */\n  flatten?: { [key: string]: FormPropMetadataArgs };\n\n  /**\n   * Declares the property as a nested child form.\n   * The property type must a complex object.\n   * This has no effect on UI rendering, only used by the mapper.\n   */\n  childForm?: boolean;\n\n  /**\n   * Type definition declaration to be used by the form builder.\n   * Setting type definition overrides any existing type definition, explicit or implicit.\n   *\n   * ## When to use:\n   * `@tdm` identify the type automatically (implicit) but you can also use the `@Prop` decorator and explicitly set the\n   * type using a type getter or the type directly (see [[PropMetadataArgs.type]]).\n   *\n   * When `rtType` is not set the form builder will use the existing type information, this is the recommended approach.\n   *\n   * You would want to use `rtType` when:\n   *   1. The existing type information is not enough AND\n   *   2. The property is not decorated with `@Prop`\n   *\n   * (1) The existing type information is usually enough but in some cases it requires manual definition done in using\n   * the `@Prop` decorator, these are the most common scenarios:\n   *   - Circular module dependency\n   *   SEE https://blog.angularindepth.com/what-is-forwardref-in-angular-and-why-we-need-it-6ecefb417d48\n   *   - When using `this` or `any` type\n   *   - When using Array of T (e.g. `string[]` or `Array<number>`)\n   *   SEE https://github.com/Microsoft/TypeScript/issues/7169\n   *\n   * (2)\n   * It is not mandatory to decorate a property with `@Prop` when decorating it with `@FormProp`, i.e. `@FormProp` can\n   * be the only decorator for a property.\n   * An example would be a property in a model/resource that is only required for the form and it is not part of the\n   * resource.\n   *\n   * If both (1) and (2) exist you would need to define a the type information using `rtType`.\n   * If only (1) exists use `@Prop` to define the type information, this will help with consistency.\n   *\n   * It might be that you will need `rtType` in other scenarios, if so remember that it will override all existing type\n   * information for the form builder only.\n   *\n   * ## How to use:\n   * The builder will auto-set missing or unset type information, if exists.\n   * Set [[TypeDefinition.ref]] property to the type, or a type getter function.\n   * Set [[TypeDefinition.forwardRef]] property to true, only then using type getter function in `ref`\n   * Set [[TypeDefinition.isArray]] property when defining a property in a `flatten` definition or when the type\n   * annotation for the property is not an array, otherwise this value is automatically set by the builder\n   *\n   * SEE [[TypeMetadataArgs]] for more information\n   */\n  rtType?: TypeMetadataArgs;\n\n  /**\n   * The default value\n   */\n  defaultValue?: any;\n\n  validators?: ValidatorFn | ValidatorFn[];\n  asyncValidators?: AsyncValidatorFn | AsyncValidatorFn[];\n}\n\nexport const BASE_RENDERER: RenderDef = {\n  vType: 'none',\n  ordinal: Number.MAX_SAFE_INTEGER\n};\n\n@MetaClass<FormPropMetadataArgs, FormPropMetadata>({\n  allowOn: [ 'member' ],\n  extend: 'mergeMap',\n  proxy: {\n    host: PropMetadata,\n    containerKey: 'form'\n  }\n})\nexport class FormPropMetadata extends BaseMetadata {\n  transform: (value: any) => any;\n  exclude: boolean;\n  required: boolean;\n  defaultValue: any;\n  render: RenderDef;\n  validators: ValidatorFn | ValidatorFn[] | null;\n  asyncValidators: AsyncValidatorFn | AsyncValidatorFn[] | null;\n  childForm: boolean;\n  flatten?: { [key: string]: FormPropMetadata };\n  rtType?: TypeMetadata;\n\n  constructor(metaArgs: FormPropMetadataArgs, info: DecoratorInfo, target?: Constructor<any>) {\n    super(info);\n    this.render = Object.create(BASE_RENDERER);\n    if ( metaArgs ) {\n      this.transform = metaArgs.transform;\n      this.exclude = metaArgs.exclude;\n      if ( metaArgs.hasOwnProperty('defaultValue') ) {\n        this.defaultValue = metaArgs.defaultValue;\n      }\n\n      this.required = metaArgs.required;\n      this.validators = metaArgs.validators || null;\n      this.asyncValidators = metaArgs.asyncValidators || null;\n      if ( !this.exclude && metaArgs.render ) {\n        if (!metaArgs.render.vType) {\n          throw new Error(`Invalid property type or type not set in ${stringify(target)}.${info.name}`);\n        }\n        Object.assign(this.render, metaArgs.render);\n      }\n\n      if ( metaArgs.childForm ) {\n        // TODO: If childForm, check type and see type is a FormModel as well\n        //       This requires some thinking because at this point the type might be undefined if it's a getter.\n        this.render.vType = 'form';\n        this.childForm = true;\n      }\n\n      if ( metaArgs.rtType ) {\n        this.rtType = new TypeMetadata(metaArgs.rtType, info, target);\n      }\n\n      if ( metaArgs.flatten ) {\n        this.flatten = {};\n        for ( let key of Object.keys(metaArgs.flatten) ) {\n          this.flatten[ key ] = new FormPropMetadata(metaArgs.flatten[ key ], { type: 'member', name: key });\n        }\n      }\n    }\n  }\n\n  static EMPTY = new FormPropMetadata({} as any, { type: 'class' });\n}\n\ndeclare module '@tdm/core/tdm/src/metadata/prop' {\n  interface PropMetadataArgs {\n    form?: FormPropMetadataArgs | undefined;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/@tdm/ngx-dynamic-forms/src/core/metadata/form-prop.ts","<mat-pseudo-checkbox *ngIf=\"multiple\" class=\"mat-option-pseudo-checkbox\" [state]=\"selected ? 'checked' : ''\" [disabled]=\"disabled\"></mat-pseudo-checkbox><span class=\"mat-option-text\"><ng-content></ng-content></span><div class=\"mat-option-ripple\" mat-ripple [matRippleTrigger]=\"_getHostElement()\" [matRippleDisabled]=\"disabled || disableRipple\"></div>\n\n\n// WEBPACK FOOTER //\n// ./node_modules/@angular/material/core/typings/index.d.ts.MatOption.html","<label class=\"mat-optgroup-label\" [id]=\"_labelId\">{{ label }}</label><ng-content select=\"mat-option, ng-container\"></ng-content>\n\n\n// WEBPACK FOOTER //\n// ./node_modules/@angular/material/core/typings/index.d.ts.MatOptgroup.html","import {\n  FormGroup,\n  FormControl,\n  AbstractControl,\n  FormArray\n} from '@angular/forms';\nimport {\n  targetStore,\n  isUndefined,\n  isFunction,\n  isPrimitive,\n  stringify,\n  directMapper,\n  Constructor,\n  TypeMetadata,\n  PropMetadata,\n  PropertyContainer,\n  MapperFactory,\n  PoClassPropertyMap,\n  SerializeMapper,\n  DeserializeMapper,\n  DirectDeserializeMapper,\n  PlainObjectMapper\n} from '@tdm/core/tdm';\n\nimport { FormModelMetadata, FormPropMetadata } from './metadata/index';\nimport { objectToForm } from '../utils';\nimport { getValidators } from '../validation';\n\nexport type DeserializableForm = FormGroup | FormArray;\n\nexport class NgFormsDeserializeMapper extends DirectDeserializeMapper {\n  readonly raw: boolean = true;\n  protected formModel: FormModelMetadata | undefined;\n\n  constructor(public formGroup: DeserializableForm, sourceType: any, plainMapper?: PlainObjectMapper) {\n    super(formGroup.value, sourceType, plainMapper);\n    this.formModel = targetStore.getMetaFor(sourceType, FormModelMetadata, true);\n  }\n\n  getIdentity(): string {\n    // TODO: Move to the global store, so logic can change without bugs.\n    if (this.identity) {\n      return this.formGroup.get(this.identity).value;\n    }\n  }\n\n  getKeys(): string[] {\n    // we don't care about excluded `FormPropMetadata` because they will not get here since the serializer\n    // will not include them, it should be a closed loop.\n    const controls = this.formGroup.controls;\n    if (this.formGroup instanceof FormArray) {\n      return [];\n    } else {\n      return Object.keys(controls).filter( k => controls[k].dirty);\n    }\n  }\n\n  getValue(key: string, prop?: PropMetadata): any {\n    const control = this.formGroup.get(key);\n    if (control instanceof FormArray) {\n      const formProp = (this.formModel && this.formModel.getProp(key as string)) || FormPropMetadata.EMPTY;\n      // TODO: we can omit this, maybe protect against but rtType should ne set at this point.\n      if (!formProp.rtType && prop && prop.type) {\n        formProp.rtType = prop.type;\n      }\n      return this.parseFormArray(control, key, formProp);\n    } else if (control instanceof FormGroup) {\n      /* NOTE:\n         Normally we would check for shared instances (relations) in the cache to prevent circular reference between 2\n         models that reference each other, however, a form value (root object) can not share the same instance\n         on 2 nodes within it's graph as it will cause infinite rendering of controls as forms are not built for this.\n\n         If, for any reason, this is required in the future, this code should ne added:\n\n         if (prop) {\n           const rel = this.getRelationQuery(prop, value);\n           if (rel) { value = rel; }\n         }\n\n         And:\n         this.getCache(type.ref, value) || this.deserialize(<any> control, prop);\n      */\n\n      const formProp = (this.formModel && this.formModel.getProp(key as string)) || FormPropMetadata.EMPTY;\n      // TODO: we can omit this, maybe protect against but rtType should ne set at this point.\n      if (!formProp.rtType && prop && prop.type) {\n        formProp.rtType = prop.type;\n      }\n      return this.parseFormGroup(control, key, formProp);\n    } else {\n      return control.value;\n    }\n  }\n\n  protected parseFormArray(control: FormArray, key: string, formProp: FormPropMetadata): any {\n    if (formProp.flatten) {\n      return this.deserializeFlattened(control, formProp, key);\n    } else {\n      const value = [];\n      for (let c of control.controls) {\n        if (c instanceof FormArray) {\n          value.push(this.parseFormArray(c, key, formProp));\n        } else if (c instanceof FormGroup) {\n          value.push(this.parseFormGroup(c, key, formProp));\n        } else {\n          value.push(c.value);\n        }\n      }\n      return value;\n    }\n  }\n\n  protected parseFormGroup(c: FormGroup, key: string, formProp: FormPropMetadata): any {\n    const type = formProp.rtType;\n    if (formProp.flatten) {\n      return this.deserializeFlattened(c, formProp, key);\n    } else if (type && targetStore.hasTarget(type.ref)) {\n      return this.deserialize(c, type);\n    } else {\n      return this.plainMapper.deserialize(c.getRawValue());\n    }\n  }\n\n  protected deserialize(value: DeserializableForm, prop: TypeMetadata): any;\n  protected deserialize(value: DeserializableForm, prop: PropMetadata): any;\n  protected deserialize(value: DeserializableForm, prop: PropMetadata | TypeMetadata): any {\n    const type: TypeMetadata = prop instanceof TypeMetadata ? prop : prop.type;\n    const mapper = this.ref\n      ? new NgFormsDeserializeMapper(value, type.ref)\n      : directMapper.deserializer(value, type.ref)\n    ;\n    return targetStore.deserialize(mapper);\n  }\n\n  /**\n   * Deserialize a control with ad-hoc \"flatten\" instruction of property to form control mappings.\n   * Flattening can only be done on complex objects so `control` must be a FormArray or FormGroup.\n   *\n   * `resultOrKey` is used to provide an existing value to merge the deserialized data into.\n   * You can also provide a string/number that used as a key to retrieve the value from an existing instance.\n   *\n   * When `resultOrKey` resolves to a NON-PRIMITIVE TRUTHY value (i.e. object/array) the deserializer will merge the\n   * value of the DIRTY controls into the object at `resultOrKey`. This means that when a `resultOrKey` is supplied only\n   * the dirty controls are evaluated and merged, a lazy approach.\n   *\n   * When `resultOrKey` resolves to a primitive value (i.e. not an object/array) or a falsy value (e.g. null/undefined)\n   * a new object is created and the deserializer will merge all of the controls, DIRTY and NOT DIRTY, into the newly\n   * created object.\n   *\n   * This base implementation of `deserializeFlattened` does not support key (string/number) retrieval as there is no\n   * model instance attached to the deserializer and so it will treat them as falsy values.\n   * Derived classes might use this option and override `deserializeFlattened` so they can re-call it after retreiving\n   * the actual value using the key.\n   *\n   * @param control The form control to deserialize, only FormArray or FormGroup\n   * @param formProp The FormPropertyMetadata instance for the property.\n   * @param resultOrKey\n   */\n  protected deserializeFlattened(control: DeserializableForm,\n                                 formProp: FormPropMetadata,\n                                 resultOrKey?: string | number | any): any {\n    if (control instanceof FormArray) {\n      const { controls } = control;\n      const result = [];\n      for (let i = 0, len = controls.length; i < len; i++) {\n        const c = controls[i];\n        if (c instanceof FormArray || c instanceof FormGroup) {\n          // we send null when c might be array, but when c is FormArray the result is force set to []\n          // null is also used to force serialization of all controls, not only the dirty one's.\n          result.push(this.deserializeFlattened(c, formProp, null));\n        } else {\n          result.push(c.value);\n        }\n      }\n      return result;\n    } else {\n      const forceSerialize = isPrimitive(resultOrKey) || !resultOrKey;\n      // this method does not support string/number in `resultOrKey`\n      const result: any = forceSerialize ? {} : resultOrKey;\n\n      const props = formProp.flatten;\n      const keys = Object.keys(props);\n      for (let key of keys) {\n        const childCtrl = control.get(key);\n        const p = props[key];\n        let value: any = keys; // keys is unique so it can never be set from the outside.\n        if (p.flatten) {\n          if (forceSerialize || childCtrl.dirty) {\n            value = this.deserializeFlattened(<any> childCtrl, p, result[key]);\n          }\n        } else if (forceSerialize || childCtrl.dirty) {\n          value = true;\n        } else if (p.hasOwnProperty('defaultValue') && p.defaultValue === control.get(key).value) {\n          value = true;\n        }\n        switch (value) {\n          case keys:\n            break;\n          case true:\n            result[key] = control.get(key).value;\n            break;\n          default:\n            if (result[key]) {\n              Object.assign(result[key], value);\n            } else {\n              result[key] = value;\n            }\n            break;\n        }\n      }\n      return result;\n    }\n  }\n}\n\n// tslint:disable-next-line\nexport class NgFormsSerializeMapper extends SerializeMapper {\n  protected cache: Map<any, any>;\n  protected formModel: FormModelMetadata | undefined;\n\n  serialize(container: PropertyContainer): any {\n    this.formModel = targetStore.getMetaFor(container.target, FormModelMetadata, true);\n    if (!this.formModel) {\n      throw new Error(`Target '${stringify(container.target)}' is not a registered FormModel`);\n    }\n\n    if (!this.cache) {\n      this.cache = new Map<any, any>();\n    }\n\n    if (Array.isArray(this.source)) {\n      return this.serializeCollection(this.source, container);\n    } else {\n      return this.serializeObject(this.source, container);\n    }\n  }\n\n  protected serializeObject(obj: any, container: PropertyContainer): FormGroup {\n    const data: FormGroup = new FormGroup({}, this.formModel.validator, this.formModel.asyncValidator);\n\n    const cb = (prop: PoClassPropertyMap) => {\n      const meta = prop.prop;\n\n      if (!meta) {\n        return;\n      }\n      const formProp = this.formModel.getProp(meta.name as string) || FormPropMetadata.EMPTY;\n      if (!formProp.rtType) {\n        formProp.rtType = meta.type;\n      }\n      const ctrl = this.createControl(formProp, obj ? obj[prop.cls] : undefined);\n      if (ctrl) {\n        data.addControl(prop.obj, ctrl);\n      }\n    };\n\n    // don't care if @Excluded was set, if @Prop there we check it\n    container.forEachRaw(obj ? Object.keys(obj) : [], cb);\n\n    const idKey = targetStore.getIdentityKey(container.target);\n    if (data.get(idKey) && idKey !== targetStore.getIdentityKey(container.target, 'outgoing')) {\n      data.removeControl(idKey);\n    }\n\n    return data;\n  }\n\n  /**\n   * Create a form control from a [[FormPropMetadata]] instance.\n   * @param formProp\n   * @param value\n   * @param ignoreArray If true, treats the type as non-array, even if the type information says it is an\n   * array. `ignoreArray` is ignored if `value` is an array instance by itself.\n   * `ignoreArray` is used when the same [[FormPropMetadata]] decorating a property of type Array<T> is used\n   * recursively, first time for the array value and then n times (array length) for the items in the array. The actual\n   * type for each item is that [[FormPropMetadata]].\n   */\n  protected createControl(formProp: FormPropMetadata, value: any, ignoreArray?: boolean): AbstractControl | undefined {\n    if (formProp.exclude) {\n      return;\n    }\n\n    if (isFunction(formProp.transform)) {\n      value = formProp.transform(value);\n    }\n\n    if (isUndefined(value)) {\n      value = formProp.defaultValue;\n    }\n\n    // we set to null, undefined will go under required validation (see `isEmptyInputValue` in @angular/forms)\n    if (isUndefined(value)) {\n      value = null;\n    }\n\n    const { rtType } = formProp;\n    const isArray = Array.isArray(value) || ( ignoreArray ? false : rtType && rtType.isArray );\n    let ctrl: AbstractControl;\n    const [syncValidator, asyncValidator] = getValidators(formProp, { required: formProp.required });\n\n    if (formProp.flatten) {\n      value = value ? this.plainMapper.serialize(value) : (isArray ? [] : {});\n      if (isArray) {\n        ctrl = new FormArray([]);\n        for (let item of value) {\n          (ctrl as FormArray).push(this.createControl(formProp, item, true));\n        }\n      } else {\n        ctrl = this.createFlatten(formProp.flatten, value);\n      }\n    } else if (formProp.childForm === true && rtType && rtType.ref) {\n      const hasTarget = targetStore.hasTarget(rtType.ref);\n      if (isArray) {\n        ctrl = new FormArray([]);\n        if (Array.isArray(value)) {\n          for (let item of value) {\n            (ctrl as FormArray).push(hasTarget ? this.serializeChild(rtType, item) : objectToForm(item));\n          }\n        }\n      } else {\n        if (value) {\n          ctrl = hasTarget ? this.serializeChild(rtType, value) : objectToForm(value);\n        } else {\n          ctrl = new FormControl();\n        }\n      }\n    } else {\n      if (isArray) {\n        ctrl = new FormArray([]);\n        if (Array.isArray(value)) {\n          for (let item of value) {\n            (ctrl as FormArray).push(new FormControl(item, syncValidator, asyncValidator));\n          }\n        }\n      } else {\n        ctrl = new FormControl(value);\n      }\n    }\n\n    if (syncValidator) {\n      ctrl.setValidators(syncValidator);\n    }\n    if (asyncValidator) {\n      ctrl.setAsyncValidators(asyncValidator);\n    }\n\n    return ctrl;\n  }\n\n  protected createFlatten(flatten: { [key: string]: FormPropMetadata }, value: any): FormGroup {\n    const ctrl = new FormGroup({});\n    const keys = Object.keys(flatten);\n    for (let key of keys) {\n      const flattenedControl = this.createControl(flatten[key], value[key]);\n      if (flattenedControl) {\n        (ctrl as FormGroup).addControl(key, flattenedControl);\n      }\n    }\n    return ctrl;\n  }\n\n  protected serializeChild(type: TypeMetadata, obj: any): FormGroup | FormArray {\n    return targetStore.serialize(type.ref as any, new NgFormsChildSerializeMapper(obj, this.cache, this.plainMapper));\n  }\n\n  protected serializeCollection(arr: any[], container: PropertyContainer): FormArray {\n    return new FormArray(arr.map(s => this.serializeObject(s, container)));\n  }\n\n  /**\n   * Creates a form control based on metadata of a given property in a given model.\n   * If a value is provided the form control will be populated with the value.\n   *\n   * You can provide a string (`prop`) representing the property name, OR if you want to create a control for a property\n   * in a nested object (Only for `@FormProp` declarations with `flatten` expressions OR `childForm` set to true) you\n   * you can provide a tuple a tuple with 2 values the first value is a string representing the\n   * property name at the root level (exposed property that `@FormProp` decorates), the second value is a dot notation\n   * path to the nested property within the flatten expression / Child model.\n   *\n   * When `tryCreateNew` is true, it will try to create new value with the new keyword using the type at the path.\n   * Creating a new value is silent, it will not throw.\n   *\n   * For example, in the following flatten expression:\n   *\n   * ```ts\n   * @FormProp({\n   *   flatten: Object.assign({}, basicFlatten, {\n   *     additional: {\n   *       flatten: {\n   *         work: { }\n   *       }\n   *     }\n   *   })\n   * })\n   * myProp: any;\n   * ```\n   * If we want to get the control for `work` the path will be: ` ['myProp', 'additional.work'] `\n   *\n   * > When using a deep path and providing a `value`, the value should be the value to be assign at the resolved path\n   * and not the root value, i.e. the value is not evaluated with each step in the path.\n   *\n   * Make sure not to include array index references within a deep path expression, think of type structure as one\n   * without arrays.\n   *\n   * NOTE: Array's are NOT SUPPORTED by design.\n   * This function DOES NOT support arrays, if a given property is an Array<T> the returned form will be T.\n   * Make sure not to send an array instance with `value`.\n   *\n   * Why?\n   * The purpose of this function is to create form controls to be added to FormArrays.\n   * These can be empty controls or populated with a given `value`.\n   * To support all features (e.g. \"flatten\") and allow empty form controls array are not supported because a property\n   * with type Array<T> and no values in the array will return an empty FormArray.\n   *\n   * If you want to create a FormArray control simple call createControl for each item in the array and add it to the\n   * FormArray:\n   *\n   * ```ts\n   * new FormArray(items.map( item => createControl(MyType, 'myProp', item) ));\n   * ```\n   */\n  static createControl<T, Z>(type: Z & Constructor<T>,\n                             prop: keyof T | [keyof T, string],\n                             value?: any,\n                             tryCreateNew?: boolean): FormGroup | FormControl | FormControl {\n    if (Array.isArray(value)) {\n      throw new Error('provided value is an array instance which is not allowed.');\n    }\n    const formProp = deepGetFormProp(type, prop);\n    if (tryCreateNew && (isUndefined(value) || value === null)) {\n      try {\n        value = new formProp.rtType.ref();\n      } catch (e) { } // tslint:disable-line\n    }\n    return <any> new NgFormsSerializeMapper(undefined).createControl(formProp, value, true);\n  }\n\n  static getFormProp: <T, Z>(type: Z & Constructor<T>,\n                             prop: keyof T | [keyof T, string]) => FormPropMetadata = deepGetFormProp;\n}\n\nfunction deepGetFormProp<T, Z>(type: Z & Constructor<T>,\n                               prop: keyof T | [keyof T, string]): FormPropMetadata {\n\n  const path: string[] = Array.isArray(prop) ? [prop[0], ...prop[1].split('.')].filter( s => !!s ) : [prop];\n\n  const formModel = targetStore.getMetaFor(type, FormModelMetadata, true);\n  if (!formModel) {\n    throw new Error(`Target '${stringify(type)}' is not a registered FormModel`);\n  }\n\n  const key = path.shift();\n  let formProp = formModel.getProp(key);\n  if (!formProp) {\n    throw new Error(`Target '${stringify(type)}' does not have a PropForm decorator for property ${key}`);\n  }\n\n  /*  At this point there are several scenarios:\n      1. `prop` is a non-deep property path (e.g. \"myProp\")\n         This is the simple scenario, we return the formProp\n\n      2. `prop` is a deep, property path (e.g. \"myProp.nest.value.somewhere\")\n          This is a bit more complex and depends on the [[FormMetadata]] configuration.\n\n            - When [[FormMetadata.flatten]] is set:\n\n              We resolve the deep path to get the [[FormMetadata]] it points to (if path is invalid we throw).\n              Once we get the [[FormMetadata]] instance we use it.\n\n            - When [[FormMetadata.childForm]] is `true`:\n\n              We need to extract the type and call deepGetFormProp again\n              with the new type and a new path, the new path is a left-shift of the current path.\n              Example: Given the model/resource `MyModel`, when resolving path \"myProp.nest.value.somewhere\"\n                       where \"myProp\" is a known model/resource `MyOtherModel` we first call:\n                          - `deepGetFormProp(MyModel, ['myProp', 'nest.value.somewhere']);`\n                       inside deepGetFormProp we detect `myProp` has `childForm: true` and\n                       that it's type is a known model/resource `MyOtherModel` so we recursively call:\n                       `deepGetFormProp(MyOtherModel, ['nest', 'value.somewhere'], value);`\n */\n\n  if (formProp.flatten) {\n    while ( formProp.flatten && path.length > 0 ) {\n      formProp = formProp.flatten[ path.shift() ];\n    }\n    if ( path.length > 0 ) {\n      throw new Error(`Error trying deep access to a flatten declaration ${(prop as string[]).join('.')}`);\n    } else if ( formProp.childForm ) {\n      if ( !formProp.rtType ) {\n        // tslint:disable-next-line\n        throw new Error(`Error trying deep access to a flatten declaration, \"rtType\" is not set but \"childForm\" is in section \"${key}\"`);\n      }\n    }\n  }\n\n  let typeMeta = formProp.rtType;\n  if (!typeMeta) {\n    const propMeta = targetStore.getMetaFor(type, PropMetadata, key);\n    formProp.rtType = typeMeta = propMeta.type;\n  }\n  if (formProp.childForm && path.length > 0) {\n    if (!targetStore.hasTarget(typeMeta.ref)) {\n      // tslint:disable-next-line\n      throw new Error(`Error trying deep access with a \"childForm\" found in path section \"${key}\", \"${typeMeta.ref}\" is not a registered model`);\n    }\n    return deepGetFormProp(typeMeta.ref, [path.shift(), path.join('.')]);\n  }\n\n  return formProp;\n}\n\n// tslint:disable-next-line\nexport class NgFormsChildSerializeMapper extends NgFormsSerializeMapper {\n  constructor(source: any, protected cache: any /*Map<string, Map<any, any>> */, plainMapper: PlainObjectMapper) {\n    super(source, plainMapper);\n  }\n}\n\nexport const ngFormsMapper: MapperFactory = {\n  serializer(source: any, plainMapper?: PlainObjectMapper): NgFormsSerializeMapper {\n    return new NgFormsSerializeMapper(source, plainMapper);\n  },\n  deserializer(source: DeserializableForm, sourceType: any, plainMapper?: PlainObjectMapper): DeserializeMapper {\n    return new NgFormsDeserializeMapper(source, sourceType, plainMapper);\n  }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/@tdm/ngx-dynamic-forms/src/core/angular-forms-mapper.ts"],"sourceRoot":"webpack:///"}